mads 2.1.5
    57 				  opt l+
   102
   103 				.print 'ZPAGE: ',zpage,'..',zpend-1
   103 				ZPAGE: $0000..$0053
   104
   105 				.print 'RTLIB: ',RTLIB,'..',*-1
   105 				RTLIB: $A07C..$A113
   106
   107 				; ------------------------------------------------------------
   108
   109 A114			START
   110 A114 BA				tsx
   111 A115 8E E9 A9			stx MAIN.@halt+1
   112
   113 					.ifdef fmulinit
   114 					fmulinit
   115 					.fi
   116
   117 = 0010			VLEN	= VARDATASIZE-VARINITSIZE
   118 = A9FC			VADR	= DATAORIGIN+VARINITSIZE
   119
   120 					ift VADR > $BFFF
   121 					ert 'Invalid memory address range ',VADR
   122 					eli (VLEN>0) && (VLEN<=256)
   123 A118 A2 F0			ldx #256-VLEN
   124 A11A A9 00			lda #$00
   125 A11C 9D 0C A9 E8 D0 FA		sta:rne VADR+VLEN-256,x+
   126 					eli VLEN>256
   127 					@fill #VADR #VLEN #$00
   128 					eif
   129
   130 				.ifdef :psptr
   131 					mwa #PROGRAMSTACK :psptr
   132 				.fi
   133
   134 A122 A2 00			ldx #$00
   135 A124 86 00			stx bp						; BP = 0
   136
   137 A126 CA				dex						; X = 255
   138
   139 A127				UNITINITIALIZATION
Macro: UNITINITIALIZATION [Source: vic20.a65]
     7 A127 20 FA A2			jsr MAIN.SYS_VIC20.@UnitInit
Source: vic20.a65
   140
   141 A12A			.local	MAIN						; PROCEDURE
   142
   143 A12A 4C 70 A9			jmp l_0067
   144
   145 				; ------------------------------------------------------------
   146
   147 A12D			.local	SYSTEM						; UNIT
   148
   149 A12D			.local	PEEK						; FUNCTION | ASSEMBLER | REGISTER
   150
   151 				; ------------------------------------------------------------
   152
   153 				; Generate Assignment for WORD / SMALLINT / SHORTREAL / POINTER
   154 				; as Pointer
   155 A12D B5 14			lda :STACKORIGIN,x
   156 A12F 85 08			sta A
   157 A131 B5 24			lda :STACKORIGIN+STACKWIDTH,x
   158 A133 85 09			sta A+1
   159 A135 CA				dex
   160 A136			@main
   161
   162 				; -------------------  ASM Block 00000002  -------------------
   163
   164 A136 A0 00			ldy #0
   165 A138 B1 08 8D FE A9		mva (:edx),y Result
   166
   167 A13D			@exit
   168
   169 				; ------------------------------------------------------------
   170
   171 				; Push BYTE / CHAR / SHORTINT / BOOLEAN
   172 				; as Pointer
   173
   174 A13D E8				inx
   175 A13E AD FE A9 95 14		mva RESULT :STACKORIGIN,x
   176
   177 					.ifdef @new
   178 					lda <@VarData
   179 					sta :ztmp
   180 					lda >@VarData
   181 					ldy #@VarDataSize-1
   182 					jmp @FreeMem
   183 					eif
   184
   185 				; ------------------------------------------------------------
   186
   187 = 0008			A	= :EDX
   188 = A9FE			RESULT	= DATAORIGIN+$0002
   189 A143 60				rts						; ret
   190 				.endl
   191
   192 A144			.local	POKE						; PROCEDURE | ASSEMBLER | REGISTER
   193
   194 				; ------------------------------------------------------------
   195
   196 				; Generate Assignment for WORD / SMALLINT / SHORTREAL / POINTER
   197 				; as Pointer
   198 A144 B5 14			lda :STACKORIGIN,x
   199 A146 85 08			sta A
   200 A148 B5 24			lda :STACKORIGIN+STACKWIDTH,x
   201 A14A 85 09			sta A+1
   202 A14C CA				dex
   203 A14D 30 05			jmi @main
   204
   205 				; ------------------------------------------------------------
   206
   207 				; Generate Assignment for BYTE / CHAR / SHORTINT / BOOLEAN
   208 				; as Pointer
   209 A14F B5 14			lda :STACKORIGIN,x
   210 A151 85 0C			sta VALUE
   211 A153 CA				dex
   212 A154			@main
   213
   214 				; -------------------  ASM Block 00000018  -------------------
   215
   216 A154 A0 00			ldy #0
   217 A156 A5 0C 91 08			mva value (:edx),y
   218
   219 				; ------------------------------------------------------------
   220
   221 = 0008			A	= :EDX
   222 = 000C			VALUE	= :ECX
   223 A15A			@exit
   224 					.ifdef @new
   225 					lda <@VarData
   226 					sta :ztmp
   227 					lda >@VarData
   228 					ldy #@VarDataSize-1
   229 					jmp @FreeMem
   230 					els
   231 A15A 60				rts						; ret
   232 					eif
   233 				.endl
   234
   235 A15B			.local	MOVE_00B1					; PROCEDURE | ASSEMBLER | OVERLOAD | REGISTER | INLINE
   236
   237 					.MACRO m@INLINE
   238 				
   239 				; -------------------  ASM Block 00000028  -------------------
   240 				
   241 					jsr @move
   242 				
   243 					.ENDM
   244
   245 				; ------------------------------------------------------------
   246
   247 = 0008			SOURCE	= :EDX
   248 = 000C			DEST	= :ECX
   249 = 0004			COUNT	= :EAX
   250 A15B			@exit
   251 				.endl
   252
   253 				; ------------------------------------------------------------
   254
   255 = 0648			M_PI_2	= $0648
   256 = 0192			D_PI_2	= $0192
   257 = 0004			D_PI_180	= $04
   258 = A9FC			RNDSEED	= DATAORIGIN+$0000
   259
   260 				.endl							; UNIT SYSTEM
   261
   262 				; ------------------------------------------------------------
   263
   264 A15B			.local	SYS_VIC20					; UNIT
   265
   266 A15B			.local	SYS_VBI						; PROCEDURE | ASSEMBLER | INTERRUPT
   267
   268 				; -------------------  ASM Block 00000048  -------------------
   269
   270 A15B E6 60		      inc RTCLOCK
   271
   272 A15D AE 13 91		      ldx VIA1DDRA
   273 A160 AC 22 91		      ldy VIA2DDRB
   274 A163 A9 C3 8D 13 91	      mva #%11000011 VIA1DDRA
   275 A168 AD 11 91		      lda VIA1PA
   276 A16B 8E 13 91		      stx VIA1DDRA
   277 A16E 29 3C		      and #%00111100                  // up, down, left, fire
   278 A170 85 61		      sta JOY
   279 A172 A9 7F 8D 22 91	      mva #%01111111 VIA2DDRB
   280 A177 AD 20 91		      lda VIA2PB
   281 A17A 8C 22 91		      sty VIA2DDRB
   282 A17D 29 80		      and #%10000000                  // right
   283 A17F 05 61		      ora JOY
   284 A181 49 BC		      eor #%10111100                  // inverse values
   285 A183 85 61		      sta JOY
   286
   287 A185 20 1A A9		      jsr VBI
   288
   289 A188 A9 40 8D 2D 91	      mva #%01000000 VIA2IFR
   290 A18D 68 A8 68 AA 68	      plr
   291
   292 A192 40				rti						; ret
   293 				.endl
   294
   295 A193			.local	SYS_INIT					; PROCEDURE | ASSEMBLER
   296
   297 				; -------------------  ASM Block 00000049  -------------------
   298
   299 A193 78			      sei
   300
   301 A194 A9 7F 8D 1E 91	      mva #%01111111 VIA1IER          // disable all NMI
   302 A199 A9 C0 8D 2E 91	      mva #%11000000 VIA2IER          // enable IRQ via2/timer1
   303 A19E A9 40 8D 2B 91	      mva #%01000000 VIA2ACR          // put via2/timer1 in continuous free-running mode
   304
   305 A1A3 A9 5B 8D 14 03 A9 +       mwa #SYS_VBI CINV               // register IRQ procedure
   306
   307 A1AD A9 00 85 60		      mva #0 RTCLOCK                  // reset raster
   308
   309 A1B1 A9 92		      lda #VBI_START                  // wait for 130 raster line
   310 A1B3 CD 04 90		@     cmp VICCR4
   311 A1B6 D0 FB		      bne @-
   312
   313 A1B8 A9 86 8D 24 91 A9 +       mwa #PAL_TIMER1 VIA2T1CL        // set via2/timer1; 1/50 sec.
   314
   315 A1C2 A0 0F		      ldy #15
   316 A1C4 B9 6C A0 99 00 90 +       mva:rpl adr.VIC_DEF,y VICCR0,y- // init VIC registers
   317
   318 A1CD 58			      cli
   319
   320 A1CE			@exit
   321 					.ifdef @new
   322 					lda <@VarData
   323 					sta :ztmp
   324 					lda >@VarData
   325 					ldy #@VarDataSize-1
   326 					jmp @FreeMem
   327 					els
   328 A1CE 60				rts						; ret
   329 					eif
   330 				.endl
   331
   332 A1CF			.local	WAIT_00DC					; PROCEDURE | ASSEMBLER | OVERLOAD | REGISTER
   333 A1CF 85 08			sta N
   334
   335 				; -------------------  ASM Block 00000052  -------------------
   336
   337 A1D1 A5 08		      lda n
   338 A1D3 18 65 60		      add RTCLOCK
   339 A1D6 C5 60		@     cmp RTCLOCK
   340 A1D8 D0 FC		      bne @-
   341
   342 				; ------------------------------------------------------------
   343
   344 = 0008			N	= :EDX
   345 A1DA			@exit
   346 					.ifdef @new
   347 					lda <@VarData
   348 					sta :ztmp
   349 					lda >@VarData
   350 					ldy #@VarDataSize-1
   351 					jmp @FreeMem
   352 					els
   353 A1DA 60				rts						; ret
   354 					eif
   355 				.endl
   356
   357 A1DB			.local	CLRSCR						; PROCEDURE | ASSEMBLER | REGISTER
   358 A1DB 85 08			sta V
   359
   360 				; -------------------  ASM Block 00000053  -------------------
   361
   362 A1DD A0 00		      ldy #0
   363 A1DF A5 08		      lda v
   364 A1E1 99 00 1C		@     sta SCREEN_ADR,y
   365 A1E4 99 00 1D		      sta SCREEN_ADR + $100,y
   366 A1E7 99 00 1E		      sta SCREEN_ADR + $200,y
   367 A1EA C8			      iny
   368 A1EB D0 F4		      bne @-
   369
   370 				; ------------------------------------------------------------
   371
   372 = 0008			V	= :EDX
   373 A1ED			@exit
   374 					.ifdef @new
   375 					lda <@VarData
   376 					sta :ztmp
   377 					lda >@VarData
   378 					ldy #@VarDataSize-1
   379 					jmp @FreeMem
   380 					els
   381 A1ED 60				rts						; ret
   382 					eif
   383 				.endl
   384
   385 A1EE			.local	CLRCOL						; PROCEDURE | ASSEMBLER | REGISTER
   386 A1EE 85 08			sta C
   387
   388 				; -------------------  ASM Block 00000054  -------------------
   389
   390 A1F0 A0 00		      ldy #0
   391 A1F2 A5 08		      lda c
   392 A1F4 99 00 94		@     sta COLORMAP_ADR,y
   393 A1F7 99 00 95		      sta COLORMAP_ADR + $100,y
   394 A1FA 99 00 96		      sta COLORMAP_ADR + $200,y
   395 A1FD C8			      iny
   396 A1FE D0 F4		      bne @-
   397
   398 				; ------------------------------------------------------------
   399
   400 = 0008			C	= :EDX
   401 A200			@exit
   402 					.ifdef @new
   403 					lda <@VarData
   404 					sta :ztmp
   405 					lda >@VarData
   406 					ldy #@VarDataSize-1
   407 					jmp @FreeMem
   408 					els
   409 A200 60				rts						; ret
   410 					eif
   411 				.endl
   412
   413 A201			.local	SET_XY						; PROCEDURE | REGISTER
   414
   415 				; optimize OK (SYS_VIC20), line = 434
   416
   417 A201 A5 08			lda X
   418 A203 85 54			sta T0B
   419 A205 A5 0C			lda Y
   420 A207 85 55			sta T1B
   421
   422 				; optimize OK (SYS_VIC20), line = 435
   423
   424 A209 A9 19			lda #$19
   425 A20B 85 0C			sta :ecx
   426 A20D A5 55			lda T1B
   427 A20F 85 04			sta :eax
   428 					.ifdef fmulinit
   429 					fmulu_8
   430 					els
   431 A211 20 FC A0			imulCL
   432 					eif
   433 A214 A5 04			lda :eax
   434 A216 85 5A			sta TMP
   435 A218 A5 05			lda :eax+1
   436 A21A 85 5B			sta TMP+1
   437 A21C A5 5A			lda TMP
   438 A21E 18 65 54			add T0B
   439 A221 85 5A			sta TMP
   440 A223 90 02			scc
   441 A225 E6 5B			inc TMP+1
   442
   443 				; optimize OK (SYS_VIC20), line = 437
   444
   445 A227 85 56			sta SCR
   446 A229 A5 5B			lda TMP+1
   447 A22B 18 69 1C			add #$1C
   448 A22E 85 57			sta SCR+1
   449
   450 				; optimize OK (SYS_VIC20), line = 438
   451
   452 A230 A5 5A			lda TMP
   453 A232 85 58			sta COLMAP
   454 A234 A5 5B			lda TMP+1
   455 A236 18 69 94			add #$94
   456 A239 85 59			sta COLMAP+1
   457
   458 				; ------------------------------------------------------------
   459
   460 = 0008			X	= :EDX
   461 = 000C			Y	= :ECX
   462 A23B			@exit
   463 					.ifdef @new
   464 					lda <@VarData
   465 					sta :ztmp
   466 					lda >@VarData
   467 					ldy #@VarDataSize-1
   468 					jmp @FreeMem
   469 					els
   470 A23B 60				rts						; ret
   471 					eif
   472 				.endl
   473
   474 A23C			.local	PRINT						; PROCEDURE | ASSEMBLER | REGISTER
   475
   476 				; -------------------  ASM Block 00000055  -------------------
   477
   478 A23C A0 00		      ldy #0
   479 A23E B1 0C 85 54		      mva (s),y ZP_0_B
   480 A242 A8 88 E6 0C		      tay:dey:inc s
   481 A246 B1 0C 91 56		@     mva (s),y (scr),y
   482 A24A A5 08 91 58		      mva col (colmap),y
   483 A24E 88			      dey
   484 A24F 10 F5		      bpl @-
   485
   486 				; ------------------------------------------------------------
   487
   488 = 0008			COL	= :EDX
   489 = 000C			S	= :ECX
   490 A251			@exit
   491 					.ifdef @new
   492 					lda <@VarData
   493 					sta :ztmp
   494 					lda >@VarData
   495 					ldy #@VarDataSize-1
   496 					jmp @FreeMem
   497 					els
   498 A251 60				rts						; ret
   499 					eif
   500 				.endl
   501
   502 A252			.local	PUT_CHAR					; PROCEDURE | ASSEMBLER | REGISTER
   503
   504 				; -------------------  ASM Block 00000056  -------------------
   505
   506 A252 A0 00		      ldy #0
   507 A254 A5 0C 91 56		      mva c (scr),y
   508 A258 A5 08 91 58		      mva col (colmap),y
   509
   510 				; ------------------------------------------------------------
   511
   512 = 0008			COL	= :EDX
   513 = 000C			C	= :ECX
   514 A25C			@exit
   515 					.ifdef @new
   516 					lda <@VarData
   517 					sta :ztmp
   518 					lda >@VarData
   519 					ldy #@VarDataSize-1
   520 					jmp @FreeMem
   521 					els
   522 A25C 60				rts						; ret
   523 					eif
   524 				.endl
   525
   526 A25D			.local	UPDATE_COUNTER_2				; PROCEDURE | ASSEMBLER | REGISTER
   527
   528 				; -------------------  ASM Block 00000057  -------------------
   529
   530 A25D F8			      sed
   531
   532 A25E A0 00		      ldy #0
   533 A260 B1 0C		      lda (counter),y
   534 A262 18 65 08		      add v
   535 A265 91 0C		      sta (counter),y
   536
   537 A267 D8			      cld
   538
   539 A268 A0 00		      ldy #0
   540 A26A B1 0C		      lda (counter),y
   541 A26C 48			      pha
   542 A26D 29 0F		      and #%00001111
   543 A26F 09 30		      ora #%00110000
   544 A271 A0 03		      ldy #3
   545 A273 91 04		      sta (scr_counter),y
   546 A275 68			      pla
   547 A276 4A 4A 4A 4A		:4    lsr
   548 A27A 09 30		      ora #%00110000
   549 A27C 88			      dey
   550 A27D 91 04		      sta (scr_counter),y
   551
   552 				; ------------------------------------------------------------
   553
   554 = 0008			V	= :EDX
   555 = 000C			COUNTER	= :ECX
   556 = 0004			SCR_COUNTER	= :EAX
   557 A27F			@exit
   558 					.ifdef @new
   559 					lda <@VarData
   560 					sta :ztmp
   561 					lda >@VarData
   562 					ldy #@VarDataSize-1
   563 					jmp @FreeMem
   564 					els
   565 A27F 60				rts						; ret
   566 					eif
   567 				.endl
   568
   569 A280			.local	UPDATE_COUNTER_4				; PROCEDURE | ASSEMBLER | REGISTER
   570
   571 				; -------------------  ASM Block 00000058  -------------------
   572
   573 A280 F8			      sed
   574
   575 A281 A0 00		      ldy #0
   576 A283 B1 0C		      lda (counter),y
   577 A285 18 65 08		      add v
   578 A288 91 0C		      sta (counter),y
   579 A28A 90 08		      bcc @+
   580 A28C C8			      iny
   581 A28D B1 0C		      lda (counter),y
   582 A28F 18 69 01		      add #1
   583 A292 91 0C		      sta (counter),y
   584
   585 A294 D8			@     cld
   586
   587 A295 A0 00		      ldy #0
   588 A297 B1 0C		      lda (counter),y
   589 A299 48			      pha
   590 A29A 29 0F		      and #%00001111
   591 A29C 09 30		      ora #%00110000
   592 A29E A0 03		      ldy #3
   593 A2A0 91 04		      sta (scr_counter),y
   594 A2A2 68			      pla
   595 A2A3 4A 4A 4A 4A		:4    lsr
   596 A2A7 09 30		      ora #%00110000
   597 A2A9 88			      dey
   598 A2AA 91 04		      sta (scr_counter),y
   599
   600 A2AC 88			      dey
   601 A2AD B1 0C		      lda (counter),y
   602 A2AF 29 0F		      and #%00001111
   603 A2B1 09 30		      ora #%00110000
   604 A2B3 91 04		      sta (scr_counter),y
   605 A2B5 B1 0C		      lda (counter),y
   606 A2B7 4A 4A 4A 4A		:4    lsr
   607 A2BB 09 30		      ora #%00110000
   608 A2BD 88			      dey
   609 A2BE 91 04		      sta (scr_counter),y
   610
   611 				; ------------------------------------------------------------
   612
   613 = 0008			V	= :EDX
   614 = 000C			COUNTER	= :ECX
   615 = 0004			SCR_COUNTER	= :EAX
   616 A2C0			@exit
   617 					.ifdef @new
   618 					lda <@VarData
   619 					sta :ztmp
   620 					lda >@VarData
   621 					ldy #@VarDataSize-1
   622 					jmp @FreeMem
   623 					els
   624 A2C0 60				rts						; ret
   625 					eif
   626 				.endl
   627
   628 A2C1			.local	PRND_0112					; PROCEDURE | ASSEMBLER | OVERLOAD
   629
   630 				; -------------------  ASM Block 00000059  -------------------
   631
   632 A2C1 AD 04 90		      lda VICCR4
   633 A2C4 65 60		      adc RTCLOCK
   634 A2C6 4D 27 91		      eor VIA2T1LH
   635 A2C9 4D 26 91		      eor VIA2T1LL
   636 A2CC 4D 14 91		      eor VIA1T1CL
   637 A2CF 4D 15 91		      eor VIA1T1CH
   638 A2D2 85 62		      sta RND
   639
   640 A2D4			@exit
   641 					.ifdef @new
   642 					lda <@VarData
   643 					sta :ztmp
   644 					lda >@VarData
   645 					ldy #@VarDataSize-1
   646 					jmp @FreeMem
   647 					els
   648 A2D4 60				rts						; ret
   649 					eif
   650 				.endl
   651
   652 A2D5			.local	PRND_0113					; PROCEDURE | OVERLOAD | REGISTER
   653
   654 				; optimize FAIL ('PRND_0112', SYS_VIC20), line = 555
   655
   656 A2D5 20 C1 A2			jsr PRND_0112
   657
   658 				; optimize OK (SYS_VIC20), line = 557
   659
   660 A2D8 A5 62			lda RND
   661 A2DA 25 04			and MASK
   662 A2DC 85 54			sta T0B
   663
   664 				; optimize OK (SYS_VIC20), line = 559
   665
   666 A2DE C5 08			cmp A
   667 A2E0 B0 05			jcs l_0137
   668 A2E2 18 65 08			add A
   669 A2E5 85 54			sta T0B
   670 A2E7			l_0137
   671
   672 				; optimize OK (SYS_VIC20), line = 560
   673
   674 A2E7 A5 0C			lda B
   675 A2E9 C5 54			cmp T0B
   676 A2EB B0 08			jcs l_0151
   677
   678 				; --- RepeatUntilProlog
   679 A2ED			l_0153
   680
   681 				; optimize OK (SYS_VIC20), line = 561
   682
   683 A2ED 46 54			lsr T0B
   684
   685 				; optimize OK (SYS_VIC20), line = 562
   686
   687 A2EF A5 0C			lda B
   688 A2F1 C5 54			cmp T0B
   689 A2F3 90 F8			jcc l_0153
   690 A2F5			l_0151
   691
   692 				; optimize OK (SYS_VIC20), line = 564
   693
   694 A2F5 A5 54			lda T0B
   695 A2F7 85 62			sta RND
   696
   697 				; ------------------------------------------------------------
   698
   699 = 0008			A	= :EDX
   700 = 000C			B	= :ECX
   701 = 0004			MASK	= :EAX
   702 A2F9			@exit
   703 					.ifdef @new
   704 					lda <@VarData
   705 					sta :ztmp
   706 					lda >@VarData
   707 					ldy #@VarDataSize-1
   708 					jmp @FreeMem
   709 					els
   710 A2F9 60				rts						; ret
   711 					eif
   712 				.endl
   713
   714 				; ------------------------------------------------------------
   715 				; ------------------------------------------------------------
   716 A2FA			@UnitInit
   717
   718 				; optimize OK (SYS_VIC20), line = 571
   719
   720 A2FA A9 00			lda #$00
   721 A2FC 85 56			sta SCR
   722 A2FE A9 1C			lda #$1C
   723 A300 85 57			sta SCR+1
   724
   725 				; optimize OK (SYS_VIC20), line = 572
   726
   727 A302 A9 00			lda #$00
   728 A304 85 58			sta COLMAP
   729 A306 A9 94			lda #$94
   730 A308 85 59			sta COLMAP+1
   731
   732 A30A 60				rts
   733
   734 				; ------------------------------------------------------------
   735
   736 = 0000			BLACK	= $00
   737 = 0001			WHITE	= $01
   738 = 0002			RED	= $02
   739 = 0003			CYAN	= $03
   740 = 0004			PURPLE	= $04
   741 = 0005			GREEN	= $05
   742 = 0006			BLUE	= $06
   743 = 0007			YELLOW	= $07
   744 = 0008			ORANGE	= $08
   745 = 0009			LIGHT_ORANGE	= $09
   746 = 000A			LIGHT_RED	= $0A
   747 = 000B			LIGHT_CYAN	= $0B
   748 = 000C			LIGHT_PURPLE	= $0C
   749 = 000D			LIGHT_GREEN	= $0D
   750 = 000E			LIGHT_BLUE	= $0E
   751 = 000F			LIGHT_YELLOW	= $0F
   752 = 1000			CHARSET_ADR	= $1000
   753 = 1C00			SCREEN_ADR	= $1C00
   754 = 9400			COLORMAP_ADR	= $9400
   755 = 0019			ROW_SIZE	= $19
   756 = 001E			COL_SIZE	= $1E
   757 = 001F			ROW_MASK	= $1F
   758 = 001F			COL_MASK	= $1F
   759 = 02EE			SCREEN_SIZE	= $02EE
   760 = 0400			CHARSET_SIZE	= $0400
   761 = A000			CART_ADR	= $A000
   762 = 2000			CART_SIZE	= $2000
   763 = 0004			JOY_UP	= $04
   764 = 0008			JOY_DOWN	= $08
   765 = 0010			JOY_LEFT	= $10
   766 = 0080			JOY_RIGHT	= $80
   767 = 0020			JOY_FIRE	= $20
   768 = 10011100		JOY_DIR_MASK	= $10011100
   769 = 0060			RTCLOCK	= $60
   770 = 0061			JOY	= $61
   771 = 0062			RND	= $62
   772 = 0054			ZP_0_B	= $54
   773 = 0055			ZP_1_B	= $55
   774 = 0056			ZP_0_W	= $56
   775 = 0058			ZP_1_W	= $58
   776 = 005A			ZP_2_W	= $5A
   777 = 005C			ZP_3_W	= $5C
   778 = 005E			ZP_0_P	= $5E
   779 = A06C			adr.VIC_DEF	= CODEORIGIN+$0060
   780 A30B			.var VIC_DEF	= adr.VIC_DEF .word
   781 = 5686			PAL_TIMER1	= $5686
   782 = 0092			VBI_START	= $92
   783 = 0314			CINV	= $0314
   784 = 0316			CBINV	= $0316
   785 = 0318			NMINV	= $0318
   786 = 9000			VICCR0	= $9000
   787 = 9001			VICCR1	= $9001
   788 = 9002			VICCR2	= $9002
   789 = 9003			VICCR3	= $9003
   790 = 9004			VICCR4	= $9004
   791 = 9005			VICCR5	= $9005
   792 = 9006			VICCR6	= $9006
   793 = 9007			VICCR7	= $9007
   794 = 9008			VICCR8	= $9008
   795 = 9009			VICCR9	= $9009
   796 = 900A			VICCRA	= $900A
   797 = 900B			VICCRB	= $900B
   798 = 900C			VICCRC	= $900C
   799 = 900D			VICCRD	= $900D
   800 = 900E			VICCRE	= $900E
   801 = 900F			VICCRF	= $900F
   802 = 9110			VIA1PB	= $9110
   803 = 9111			VIA1PA	= $9111
   804 = 9112			VIA1DDRB	= $9112
   805 = 9113			VIA1DDRA	= $9113
   806 = 9114			VIA1T1CL	= $9114
   807 = 9115			VIA1T1CH	= $9115
   808 = 9116			VIA1T1LL	= $9116
   809 = 9117			VIA1T1LH	= $9117
   810 = 9118			VIA1T2CL	= $9118
   811 = 9119			VIA1T2CH	= $9119
   812 = 911A			VIA1SR	= $911A
   813 = 911B			VIA1ACR	= $911B
   814 = 911C			VIA1PCR	= $911C
   815 = 911D			VIA1IFR	= $911D
   816 = 911E			VIA1IER	= $911E
   817 = 911F			VIA1PA2	= $911F
   818 = 9120			VIA2PB	= $9120
   819 = 9121			VIA2PA	= $9121
   820 = 9122			VIA2DDRB	= $9122
   821 = 9123			VIA2DDRA	= $9123
   822 = 9124			VIA2T1CL	= $9124
   823 = 9125			VIA2T1CH	= $9125
   824 = 9126			VIA2T1LL	= $9126
   825 = 9127			VIA2T1LH	= $9127
   826 = 9128			VIA2T2CL	= $9128
   827 = 9129			VIA2T2CH	= $9129
   828 = 912A			VIA2SR	= $912A
   829 = 912B			VIA2ACR	= $912B
   830 = 912C			VIA2PCR	= $912C
   831 = 912D			VIA2IFR	= $912D
   832 = 912E			VIA2IER	= $912E
   833 = 912F			VIA2PA2	= $912F
   834 = 0056			SCR	= $56
   835 = 0058			COLMAP	= $58
   836 = 005A			TMP	= $5A
   837 = 005E			GAME_VBI	= $5E
   838 = 0054			T0B	= $54
   839 = 0055			T1B	= $55
   840
   841 = A30B 6C A0		VIC_DEF
   841 				.endl							; UNIT SYS_VIC20
   842
   843 A30D			.local	WELCOME_SCR					; PROCEDURE | INLINE
   844
   845 					.MACRO m@INLINE
   846 				
   847 				; optimize OK (game.inc), line = 82
   848 				
   849 					lda #$01
   850 					jsr SYS_VIC20.CLRCOL
   851 				
   852 				; optimize OK (game.inc), line = 84
   853 				
   854 					lda #$0C
   855 					sta T0B
   856 					sta T2B
   857 				
   858 				; optimize OK (game.inc), line = 86
   859 				
   860 					lda adr.TXT_INFO
   861 					lsr @
   862 					sta T1B
   863 					lda T0B
   864 					sub T1B
   865 					sta T0B
   866 				
   867 				; optimize OK (game.inc), line = 87
   868 				
   869 					sta SYS_VIC20.SET_XY.X
   870 					lda #$02
   871 					sta SYS_VIC20.SET_XY.Y
   872 					jsr SYS_VIC20.SET_XY
   873 				
   874 				; optimize OK (game.inc), line = 88
   875 				
   876 					lda #$07
   877 					sta SYS_VIC20.PRINT.COL
   878 					lda #$53
   879 					sta SYS_VIC20.PRINT.S
   880 					lda #$A0
   881 					sta SYS_VIC20.PRINT.S+1
   882 					jsr SYS_VIC20.PRINT
   883 				
   884 				; optimize OK (game.inc), line = 90
   885 				
   886 					lda adr.TXT_TURBO
   887 					lsr @
   888 					sta T1B
   889 					lda T2B
   890 					sub T1B
   891 					sta T2B
   892 				
   893 				; optimize OK (game.inc), line = 91
   894 				
   895 					sta SYS_VIC20.SET_XY.X
   896 					lda #$19
   897 					sta SYS_VIC20.SET_XY.Y
   898 					jsr SYS_VIC20.SET_XY
   899 				
   900 				; optimize OK (game.inc), line = 92
   901 				
   902 					lda #$07
   903 					sta SYS_VIC20.PRINT.COL
   904 					lda #$3E
   905 					sta SYS_VIC20.PRINT.S
   906 					lda #$A0
   907 					sta SYS_VIC20.PRINT.S+1
   908 					jsr SYS_VIC20.PRINT
   909 				
   910 				; --- RepeatUntilProlog
   911 				l_01AF
   912 				
   913 				; optimize OK (game.inc), line = 94
   914 				
   915 					lda SYS_VIC20.JOY
   916 					and #$20
   917 					jeq l_01AF
   918 					.ENDM
   919 A30D			@exit
   920 				.endl
   921
   922 A30D			.local	DRAW_FRAME					; PROCEDURE
   923
   924 				; optimize OK (game.inc), line = 103
   925
   926 A30D A9 19			lda #$19
   927 A30F 85 73			sta T0W
   928 A311 A9 1C			lda #$1C
   929 A313 85 74			sta T0W+1
   930 A315 A9 19			lda #$19
   931 A317 85 75			sta T1W
   932 A319 A9 94			lda #$94
   933 A31B 85 76			sta T1W+1
   934
   935 				; optimize OK (game.inc), line = 104
   936
   937 A31D A9 1A			lda #$1A
   938 A31F 85 70			sta I
   939
   940 A321			l_01D5
   941 				; --- ForToDoCondition
   942
   943 				; optimize OK (game.inc), line = 105
   944
   945 A321 A4 74			ldy T0W+1
   946 A323 84 01			sty :bp+1
   947 A325 A4 73			ldy T0W
   948 A327 A9 43			lda #$43
   949 A329 91 00			sta (:bp),y
   950
   951 				; optimize OK (game.inc), line = 106
   952
   953 A32B A4 73 84 02 A4 74 + 	mwy T0W :bp2
   954 A333 A0 18			ldy #$18
   955 A335 A9 42			lda #$42
   956 A337 91 02			sta (:bp2),y
   957
   958 				; optimize OK (game.inc), line = 107
   959
   960 A339 A4 76			ldy T1W+1
   961 A33B 84 01			sty :bp+1
   962 A33D A4 75			ldy T1W
   963 A33F A9 07			lda #$07
   964 A341 91 00			sta (:bp),y
   965
   966 				; optimize OK (game.inc), line = 108
   967
   968 A343 A4 75 84 02 A4 76 + 	mwy T1W :bp2
   969 A34B A0 18			ldy #$18
   970 A34D 91 02			sta (:bp2),y
   971
   972 				; optimize OK (game.inc), line = 109
   973
   974 A34F A5 73			lda T0W
   975 A351 18 69 19			add #$19
   976 A354 85 73			sta T0W
   977 A356 90 02			scc
   978 A358 E6 74			inc T0W+1
   979
   980 				; optimize OK (game.inc), line = 110
   981
   982 A35A A5 75			lda T1W
   983 A35C 18 69 19			add #$19
   984 A35F 85 75			sta T1W
   985 A361 90 02			scc
   986 A363 E6 76			inc T1W+1
   987
   988 				; --- ForToDoEpilog
   989 A365 C6 70			dec I
   990 A367 10 B8			jpl l_01D5
   991 A369			l_01E3
   992
   993 				; optimize OK (game.inc), line = 113
   994
   995 A369 A9 18			lda #$18
   996 A36B 85 70			sta I
   997
   998 A36D			l_020B
   999 				; --- ForToDoCondition
  1000
  1001 				; optimize OK (game.inc), line = 114
  1002
  1003 A36D A4 70			ldy I
  1004 A36F A9 41			lda #$41
  1005 A371 99 00 1C			sta $1C00,y
  1006
  1007 				; optimize OK (game.inc), line = 115
  1008
  1009 A374 99 BC 1E			sta $1EBC,y
  1010
  1011 				; optimize OK (game.inc), line = 116
  1012
  1013 A377 A9 07			lda #$07
  1014 A379 99 00 94			sta $9400,y
  1015
  1016 				; optimize OK (game.inc), line = 117
  1017
  1018 A37C 99 BC 96			sta $96BC,y
  1019
  1020 				; --- ForToDoEpilog
  1021 A37F C6 70			dec I
  1022 A381 10 EA			jpl l_020B
  1023 A383			l_0219
  1024
  1025 				; ------------------------------------------------------------
  1026
  1027 = 0070			I	= $70
  1028 A383			@exit
  1029 					.ifdef @new
  1030 					lda <@VarData
  1031 					sta :ztmp
  1032 					lda >@VarData
  1033 					ldy #@VarDataSize-1
  1034 					jmp @FreeMem
  1035 					els
  1036 A383 60				rts						; ret
  1037 					eif
  1038 				.endl
  1039
  1040 A384			.local	PRESS_FIRE					; PROCEDURE
  1041
  1042 				; optimize OK (game.inc), line = 125
  1043
  1044 A384 A9 19			lda #$19
  1045 A386 38 ED 32 A0			sub adr.TXT_FIRE
  1046 A38A 38 E9 02			sub #$02
  1047 A38D 85 08			sta SYS_VIC20.SET_XY.X
  1048 A38F A9 00			lda #$00
  1049 A391 85 0C			sta SYS_VIC20.SET_XY.Y
  1050 A393 20 01 A2			jsr SYS_VIC20.SET_XY
  1051
  1052 				; optimize OK (game.inc), line = 126
  1053
  1054 A396 A9 01			lda #$01
  1055 A398 85 08			sta SYS_VIC20.PRINT.COL
  1056 A39A A9 32			lda #$32
  1057 A39C 85 0C			sta SYS_VIC20.PRINT.S
  1058 A39E A9 A0			lda #$A0
  1059 A3A0 85 0D			sta SYS_VIC20.PRINT.S+1
  1060 A3A2 20 3C A2			jsr SYS_VIC20.PRINT
  1061
  1062 				; --- RepeatUntilProlog
  1063 A3A5			l_0254
  1064
  1065 				; optimize OK (game.inc), line = 128
  1066
  1067 A3A5 A5 61			lda SYS_VIC20.JOY
  1068 A3A7 29 20			and #$20
  1069 A3A9 F0 FA			jeq l_0254
  1070 A3AB			@exit
  1071 					.ifdef @new
  1072 					lda <@VarData
  1073 					sta :ztmp
  1074 					lda >@VarData
  1075 					ldy #@VarDataSize-1
  1076 					jmp @FreeMem
  1077 					els
  1078 A3AB 60				rts						; ret
  1079 					eif
  1080 				.endl
  1081
  1082 A3AC			.local	PUT_SNAKE					; PROCEDURE
  1083
  1084 				; optimize OK (game.inc), line = 135
  1085
  1086 A3AC A9 44			lda #$44
  1087 A3AE 85 7A			sta HEAD_DIR
  1088
  1089 				; optimize OK (game.inc), line = 136
  1090
  1091 A3B0 85 79			sta TAIL_DIR
  1092
  1093 				; optimize OK (game.inc), line = 137
  1094
  1095 A3B2 A9 83			lda #$83
  1096 A3B4 85 84			sta HEAD_POS
  1097 A3B6 A9 1D			lda #$1D
  1098 A3B8 85 85			sta HEAD_POS+1
  1099
  1100 				; optimize OK (game.inc), line = 138
  1101
  1102 A3BA A9 83			lda #$83
  1103 A3BC 85 86			sta HEAD_POS_COL
  1104 A3BE A9 95			lda #$95
  1105 A3C0 85 87			sta HEAD_POS_COL+1
  1106
  1107 				; optimize OK (game.inc), line = 140
  1108
  1109 A3C2 A4 85			ldy HEAD_POS+1
  1110 A3C4 84 01			sty :bp+1
  1111 A3C6 A4 84			ldy HEAD_POS
  1112 A3C8 A9 48			lda #$48
  1113 A3CA 91 00			sta (:bp),y
  1114 A3CC A4 87			ldy HEAD_POS_COL+1
  1115 A3CE 84 01			sty :bp+1
  1116 A3D0 A4 86			ldy HEAD_POS_COL
  1117 A3D2 A9 01			lda #$01
  1118 A3D4 91 00			sta (:bp),y
  1119
  1120 				; optimize OK (game.inc), line = 142
  1121
  1122 A3D6 A5 84			lda HEAD_POS
  1123 A3D8 85 73			sta T0W
  1124 A3DA A5 85			lda HEAD_POS+1
  1125 A3DC 85 74			sta T0W+1
  1126 A3DE A5 86			lda HEAD_POS_COL
  1127 A3E0 85 75			sta T1W
  1128 A3E2 A5 87			lda HEAD_POS_COL+1
  1129 A3E4 85 76			sta T1W+1
  1130
  1131 				; optimize OK (game.inc), line = 143
  1132
  1133 A3E6 A9 00			lda #$00
  1134 A3E8 85 70			sta T0B
  1135
  1136 A3EA			l_0294
  1137 				; --- ForToDoCondition
  1138
  1139 				; optimize OK (game.inc), line = 144
  1140
  1141 A3EA A5 73			lda T0W
  1142 A3EC 18 69 19			add #$19
  1143 A3EF 85 73			sta T0W
  1144 A3F1 90 02			scc
  1145 A3F3 E6 74			inc T0W+1
  1146 A3F5 A5 75			lda T1W
  1147 A3F7 18 69 19			add #$19
  1148 A3FA 85 75			sta T1W
  1149 A3FC 90 02			scc
  1150 A3FE E6 76			inc T1W+1
  1151
  1152 				; optimize OK (game.inc), line = 145
  1153
  1154 A400 A4 74			ldy T0W+1
  1155 A402 84 01			sty :bp+1
  1156 A404 A4 73			ldy T0W
  1157 A406 A9 4C			lda #$4C
  1158 A408 91 00			sta (:bp),y
  1159 A40A A4 76			ldy T1W+1
  1160 A40C 84 01			sty :bp+1
  1161 A40E A4 75			ldy T1W
  1162 A410 A9 01			lda #$01
  1163 A412 91 00			sta (:bp),y
  1164
  1165 				; --- ForToDoEpilog
  1166 A414 C6 70			dec T0B
  1167 A416 10 D2			jpl l_0294
  1168 A418			l_02A2
  1169
  1170 				; optimize OK (game.inc), line = 148
  1171
  1172 A418 A5 73			lda T0W
  1173 A41A 18 69 19			add #$19
  1174 A41D 85 73			sta T0W
  1175 A41F 90 02			scc
  1176 A421 E6 74			inc T0W+1
  1177 A423 A5 75			lda T1W
  1178 A425 18 69 19			add #$19
  1179 A428 85 75			sta T1W
  1180 A42A 90 02			scc
  1181 A42C E6 76			inc T1W+1
  1182 A42E A5 73			lda T0W
  1183 A430 85 88			sta TAIL_POS
  1184 A432 A5 74			lda T0W+1
  1185 A434 85 89			sta TAIL_POS+1
  1186
  1187 				; optimize OK (game.inc), line = 149
  1188
  1189 A436 85 01			sta :bp+1
  1190 A438 A4 88			ldy TAIL_POS
  1191 A43A A9 44			lda #$44
  1192 A43C 91 00			sta (:bp),y
  1193 A43E A4 76			ldy T1W+1
  1194 A440 84 01			sty :bp+1
  1195 A442 A4 75			ldy T1W
  1196 A444 A9 01			lda #$01
  1197 A446 91 00			sta (:bp),y
  1198
  1199 				; ------------------------------------------------------------
  1200
  1201 A448			@exit
  1202 					.ifdef @new
  1203 					lda <@VarData
  1204 					sta :ztmp
  1205 					lda >@VarData
  1206 					ldy #@VarDataSize-1
  1207 					jmp @FreeMem
  1208 					els
  1209 A448 60				rts						; ret
  1210 					eif
  1211 				.endl
  1212
  1213 A449			.local	DRAW_BOTTOM_LINE				; PROCEDURE
  1214
  1215 				; optimize OK (game.inc), line = 156
  1216
  1217 A449 A9 00			lda #$00
  1218 A44B 85 08			sta SYS_VIC20.SET_XY.X
  1219 A44D A9 1D			lda #$1D
  1220 A44F 85 0C			sta SYS_VIC20.SET_XY.Y
  1221 A451 20 01 A2			jsr SYS_VIC20.SET_XY
  1222
  1223 				; optimize OK (game.inc), line = 157
  1224
  1225 A454 A9 01			lda #$01
  1226 A456 85 08			sta SYS_VIC20.PRINT.COL
  1227 A458 A9 0C			lda #$0C
  1228 A45A 85 0C			sta SYS_VIC20.PRINT.S
  1229 A45C A9 A0			lda #$A0
  1230 A45E 85 0D			sta SYS_VIC20.PRINT.S+1
  1231 A460 20 3C A2			jsr SYS_VIC20.PRINT
  1232
  1233 				; optimize OK (game.inc), line = 159
  1234
  1235 A463 AD 0C A0			lda adr.TXT_LEVEL
  1236 A466 18 69 01			add #$01
  1237 A469 85 08			sta SYS_VIC20.SET_XY.X
  1238 A46B A9 1D			lda #$1D
  1239 A46D 85 0C			sta SYS_VIC20.SET_XY.Y
  1240 A46F 20 01 A2			jsr SYS_VIC20.SET_XY
  1241
  1242 				; optimize OK (game.inc), line = 160
  1243
  1244 A472 A9 01			lda #$01
  1245 A474 85 08			sta SYS_VIC20.PRINT.COL
  1246 A476 A9 23			lda #$23
  1247 A478 85 0C			sta SYS_VIC20.PRINT.S
  1248 A47A A9 A0			lda #$A0
  1249 A47C 85 0D			sta SYS_VIC20.PRINT.S+1
  1250 A47E 20 3C A2			jsr SYS_VIC20.PRINT
  1251
  1252 				; optimize OK (game.inc), line = 162
  1253
  1254 A481 A9 19			lda #$19
  1255 A483 38 ED 16 A0			sub adr.TXT_POINTS
  1256 A487 85 08			sta SYS_VIC20.SET_XY.X
  1257 A489 A9 1D			lda #$1D
  1258 A48B 85 0C			sta SYS_VIC20.SET_XY.Y
  1259 A48D 20 01 A2			jsr SYS_VIC20.SET_XY
  1260
  1261 				; optimize OK (game.inc), line = 163
  1262
  1263 A490 A9 01			lda #$01
  1264 A492 85 08			sta SYS_VIC20.PRINT.COL
  1265 A494 A9 16			lda #$16
  1266 A496 85 0C			sta SYS_VIC20.PRINT.S
  1267 A498 A9 A0			lda #$A0
  1268 A49A 85 0D			sta SYS_VIC20.PRINT.S+1
  1269 A49C 20 3C A2			jsr SYS_VIC20.PRINT
  1270 A49F			@exit
  1271 					.ifdef @new
  1272 					lda <@VarData
  1273 					sta :ztmp
  1274 					lda >@VarData
  1275 					ldy #@VarDataSize-1
  1276 					jmp @FreeMem
  1277 					els
  1278 A49F 60				rts						; ret
  1279 					eif
  1280 				.endl
  1281
  1282 A4A0			.local	PRINT_HI_SCORE					; PROCEDURE
  1283
  1284 				; optimize OK (game.inc), line = 170
  1285
  1286 A4A0 A9 02			lda #$02
  1287 A4A2 85 08			sta SYS_VIC20.SET_XY.X
  1288 A4A4 A9 00			lda #$00
  1289 A4A6 85 0C			sta SYS_VIC20.SET_XY.Y
  1290 A4A8 20 01 A2			jsr SYS_VIC20.SET_XY
  1291
  1292 				; optimize OK (game.inc), line = 171
  1293
  1294 A4AB A9 01			lda #$01
  1295 A4AD 85 08			sta SYS_VIC20.PRINT.COL
  1296 A4AF A9 29			lda #$29
  1297 A4B1 85 0C			sta SYS_VIC20.PRINT.S
  1298 A4B3 A9 A0			lda #$A0
  1299 A4B5 85 0D			sta SYS_VIC20.PRINT.S+1
  1300 A4B7 20 3C A2			jsr SYS_VIC20.PRINT
  1301
  1302 				; optimize OK (game.inc), line = 172
  1303
  1304 A4BA A9 00			lda #$00
  1305 A4BC 85 08			sta SYS_VIC20.UPDATE_COUNTER_4.V
  1306 A4BE A9 82			lda #$82
  1307 A4C0 85 0C			sta SYS_VIC20.UPDATE_COUNTER_4.COUNTER
  1308 A4C2 A9 00			lda #$00
  1309 A4C4 85 0D			sta SYS_VIC20.UPDATE_COUNTER_4.COUNTER+1
  1310 A4C6 A9 05			lda #$05
  1311 A4C8 85 04			sta SYS_VIC20.UPDATE_COUNTER_4.SCR_COUNTER
  1312 A4CA A9 1C			lda #$1C
  1313 A4CC 85 05			sta SYS_VIC20.UPDATE_COUNTER_4.SCR_COUNTER+1
  1314 A4CE 20 80 A2			jsr SYS_VIC20.UPDATE_COUNTER_4
  1315 A4D1			@exit
  1316 					.ifdef @new
  1317 					lda <@VarData
  1318 					sta :ztmp
  1319 					lda >@VarData
  1320 					ldy #@VarDataSize-1
  1321 					jmp @FreeMem
  1322 					els
  1323 A4D1 60				rts						; ret
  1324 					eif
  1325 				.endl
  1326
  1327 A4D2			.local	HALL_OF_FAME					; PROCEDURE
  1328
  1329 				; optimize OK (game.inc), line = 179
  1330
  1331 A4D2 A5 83			lda HI_SCORE_BCD+1
  1332 A4D4 C5 81			cmp SCORE_BCD+1
  1333 A4D6 D0 04			bne @+
  1334 A4D8 A5 82			lda HI_SCORE_BCD
  1335 A4DA C5 80			cmp SCORE_BCD
  1336 				@
  1337 A4DC B0 08			jcs l_0300
  1338 A4DE A5 80			lda SCORE_BCD
  1339 A4E0 85 82			sta HI_SCORE_BCD
  1340 A4E2 A5 81			lda SCORE_BCD+1
  1341 A4E4 85 83			sta HI_SCORE_BCD+1
  1342 A4E6			l_0300
  1343
  1344 				; optimize FAIL ('PRINT_HI_SCORE', game.inc), line = 180
  1345
  1346 A4E6 20 A0 A4			jsr PRINT_HI_SCORE
  1347 A4E9			@exit
  1348 					.ifdef @new
  1349 					lda <@VarData
  1350 					sta :ztmp
  1351 					lda >@VarData
  1352 					ldy #@VarDataSize-1
  1353 					jmp @FreeMem
  1354 					els
  1355 A4E9 60				rts						; ret
  1356 					eif
  1357 				.endl
  1358
  1359 A4EA			.local	MOVE_TAIL					; PROCEDURE
  1360
  1361 				; optimize OK (game.inc), line = 187
  1362
  1363 A4EA A4 89			ldy TAIL_POS+1
  1364 A4EC 84 01			sty :bp+1
  1365 A4EE A4 88			ldy TAIL_POS
  1366 A4F0 A9 20			lda #$20
  1367 A4F2 91 00			sta (:bp),y
  1368
  1369 				; optimize OK (game.inc), line = 189
  1370
  1371 A4F4 A5 79			lda TAIL_DIR
  1372 A4F6 8D FF A9			sta @CASETMP_0003
  1373 A4F9 C9 44			cmp #$44
  1374 A4FB D0 0E			jne l_031C
  1375 				@
  1376
  1377 				; optimize OK (game.inc), line = 190
  1378
  1379 A4FD A5 88			lda TAIL_POS
  1380 A4FF 38 E9 19			sub #$19
  1381 A502 85 88			sta TAIL_POS
  1382 A504 B0 02			scs
  1383 A506 C6 89			dec TAIL_POS+1
  1384
  1385 A508 4C 36 A5			jmp a_0003
  1386 A50B			l_031C
  1387 A50B C9 45			cmp #$45
  1388 A50D D0 0E			jne l_0326
  1389 				@
  1390
  1391 				; optimize OK (game.inc), line = 191
  1392
  1393 A50F A5 88			lda TAIL_POS
  1394 A511 18 69 19			add #$19
  1395 A514 85 88			sta TAIL_POS
  1396 A516 90 02			scc
  1397 A518 E6 89			inc TAIL_POS+1
  1398
  1399 A51A 4C 36 A5			jmp a_0003
  1400 A51D			l_0326
  1401 A51D C9 46			cmp #$46
  1402 A51F D0 09			jne l_0330
  1403 				@
  1404
  1405 				; optimize FAIL (0, game.inc), line = 192
  1406
  1407 A521 E6 88			inc TAIL_POS
  1408 A523 D0 02			sne
  1409 A525 E6 89			inc TAIL_POS+1
  1410
  1411 A527 4C 36 A5			jmp a_0003
  1412 A52A			l_0330
  1413 A52A C9 47			cmp #$47
  1414 A52C D0 08			jne l_033D
  1415 				@
  1416
  1417 				; optimize FAIL (0, game.inc), line = 193
  1418
  1419 A52E A5 88			lda TAIL_POS
  1420 A530 D0 02			bne @+
  1421 A532 C6 89			dec TAIL_POS+1
  1422 				@
  1423 A534 C6 88			dec TAIL_POS
  1424
  1425 A536			l_033D
  1426 A536			a_0003
  1427
  1428 				; optimize OK (game.inc), line = 196
  1429
  1430 A536 A4 89			ldy TAIL_POS+1
  1431 A538 84 01			sty :bp+1
  1432 A53A A4 88			ldy TAIL_POS
  1433 A53C B1 00			lda (:bp),y
  1434 A53E 85 70			sta T0B
  1435
  1436 				; optimize OK (game.inc), line = 198
  1437
  1438 A540 A5 79			lda TAIL_DIR
  1439 A542 8D 00 AA			sta @CASETMP_0004
  1440 A545 C9 44			cmp #$44
  1441 A547 D0 26			jne l_035A
  1442 				@
  1443
  1444 				; optimize OK (game.inc), line = 200
  1445
  1446 A549 A5 70			lda T0B
  1447 A54B 8D 01 AA			sta @CASETMP_0005
  1448 A54E C9 4C			cmp #$4C
  1449 A550 D0 07			jne l_0365
  1450 				@
  1451
  1452 				; optimize OK (game.inc), line = 201
  1453
  1454 A552 A9 44			lda #$44
  1455 A554 85 79			sta TAIL_DIR
  1456
  1457 A556 4C 6C A5			jmp a_0005
  1458 A559			l_0365
  1459 A559 C9 50			cmp #$50
  1460 A55B D0 07			jne l_0372
  1461 				@
  1462
  1463 				; optimize OK (game.inc), line = 202
  1464
  1465 A55D A9 47			lda #$47
  1466 A55F 85 79			sta TAIL_DIR
  1467
  1468 A561 4C 6C A5			jmp a_0005
  1469 A564			l_0372
  1470 A564 C9 51			cmp #$51
  1471 A566 D0 04			jne l_037F
  1472 				@
  1473
  1474 				; optimize OK (game.inc), line = 203
  1475
  1476 A568 A9 46			lda #$46
  1477 A56A 85 79			sta TAIL_DIR
  1478
  1479 A56C			l_037F
  1480 A56C			a_0005
  1481
  1482 A56C 4C EA A5			jmp a_0004
  1483 A56F			l_035A
  1484 A56F C9 45			cmp #$45
  1485 A571 D0 26			jne l_0393
  1486 				@
  1487
  1488 				; optimize OK (game.inc), line = 207
  1489
  1490 A573 A5 70			lda T0B
  1491 A575 8D 02 AA			sta @CASETMP_0006
  1492 A578 C9 4C			cmp #$4C
  1493 A57A D0 07			jne l_039E
  1494 				@
  1495
  1496 				; optimize OK (game.inc), line = 208
  1497
  1498 A57C A9 45			lda #$45
  1499 A57E 85 79			sta TAIL_DIR
  1500
  1501 A580 4C 96 A5			jmp a_0006
  1502 A583			l_039E
  1503 A583 C9 4E			cmp #$4E
  1504 A585 D0 07			jne l_03AB
  1505 				@
  1506
  1507 				; optimize OK (game.inc), line = 209
  1508
  1509 A587 A9 47			lda #$47
  1510 A589 85 79			sta TAIL_DIR
  1511
  1512 A58B 4C 96 A5			jmp a_0006
  1513 A58E			l_03AB
  1514 A58E C9 4F			cmp #$4F
  1515 A590 D0 04			jne l_03B8
  1516 				@
  1517
  1518 				; optimize OK (game.inc), line = 210
  1519
  1520 A592 A9 46			lda #$46
  1521 A594 85 79			sta TAIL_DIR
  1522
  1523 A596			l_03B8
  1524 A596			a_0006
  1525
  1526 A596 4C EA A5			jmp a_0004
  1527 A599			l_0393
  1528 A599 C9 46			cmp #$46
  1529 A59B D0 26			jne l_03CC
  1530 				@
  1531
  1532 				; optimize OK (game.inc), line = 214
  1533
  1534 A59D A5 70			lda T0B
  1535 A59F 8D 03 AA			sta @CASETMP_0007
  1536 A5A2 C9 4D			cmp #$4D
  1537 A5A4 D0 07			jne l_03D7
  1538 				@
  1539
  1540 				; optimize OK (game.inc), line = 215
  1541
  1542 A5A6 A9 46			lda #$46
  1543 A5A8 85 79			sta TAIL_DIR
  1544
  1545 A5AA 4C C0 A5			jmp a_0007
  1546 A5AD			l_03D7
  1547 A5AD C9 4E			cmp #$4E
  1548 A5AF D0 07			jne l_03E4
  1549 				@
  1550
  1551 				; optimize OK (game.inc), line = 216
  1552
  1553 A5B1 A9 44			lda #$44
  1554 A5B3 85 79			sta TAIL_DIR
  1555
  1556 A5B5 4C C0 A5			jmp a_0007
  1557 A5B8			l_03E4
  1558 A5B8 C9 50			cmp #$50
  1559 A5BA D0 04			jne l_03F1
  1560 				@
  1561
  1562 				; optimize OK (game.inc), line = 217
  1563
  1564 A5BC A9 45			lda #$45
  1565 A5BE 85 79			sta TAIL_DIR
  1566
  1567 A5C0			l_03F1
  1568 A5C0			a_0007
  1569
  1570 A5C0 4C EA A5			jmp a_0004
  1571 A5C3			l_03CC
  1572 A5C3 C9 47			cmp #$47
  1573 A5C5 D0 23			jne l_0405
  1574 				@
  1575
  1576 				; optimize OK (game.inc), line = 221
  1577
  1578 A5C7 A5 70			lda T0B
  1579 A5C9 8D 04 AA			sta @CASETMP_0008
  1580 A5CC C9 4D			cmp #$4D
  1581 A5CE D0 07			jne l_0410
  1582 				@
  1583
  1584 				; optimize OK (game.inc), line = 222
  1585
  1586 A5D0 A9 47			lda #$47
  1587 A5D2 85 79			sta TAIL_DIR
  1588
  1589 A5D4 4C EA A5			jmp a_0008
  1590 A5D7			l_0410
  1591 A5D7 C9 4F			cmp #$4F
  1592 A5D9 D0 07			jne l_041D
  1593 				@
  1594
  1595 				; optimize OK (game.inc), line = 223
  1596
  1597 A5DB A9 44			lda #$44
  1598 A5DD 85 79			sta TAIL_DIR
  1599
  1600 A5DF 4C EA A5			jmp a_0008
  1601 A5E2			l_041D
  1602 A5E2 C9 51			cmp #$51
  1603 A5E4 D0 04			jne l_042A
  1604 				@
  1605
  1606 				; optimize OK (game.inc), line = 224
  1607
  1608 A5E6 A9 45			lda #$45
  1609 A5E8 85 79			sta TAIL_DIR
  1610
  1611 A5EA			l_042A
  1612 A5EA			a_0008
  1613
  1614 A5EA			l_0405
  1615 A5EA			a_0004
  1616
  1617 				; optimize OK (game.inc), line = 229
  1618
  1619 A5EA A4 89			ldy TAIL_POS+1
  1620 A5EC 84 01			sty :bp+1
  1621 A5EE A4 88			ldy TAIL_POS
  1622 A5F0 A5 79			lda TAIL_DIR
  1623 A5F2 91 00			sta (:bp),y
  1624
  1625 				; ------------------------------------------------------------
  1626
  1627 = A9FF			@CASETMP_0003	= DATAORIGIN+$0003
  1628 = AA00			@CASETMP_0004	= DATAORIGIN+$0004
  1629 = AA01			@CASETMP_0005	= DATAORIGIN+$0005
  1630 = AA02			@CASETMP_0006	= DATAORIGIN+$0006
  1631 = AA03			@CASETMP_0007	= DATAORIGIN+$0007
  1632 = AA04			@CASETMP_0008	= DATAORIGIN+$0008
  1633
  1634 = A9FF			@VarData	= @CASETMP_0003
  1635 = 0006			@VarDataSize	= 6
  1636
  1637 A5F4			@exit
  1638 					.ifdef @new
  1639 					lda <@VarData
  1640 					sta :ztmp
  1641 					lda >@VarData
  1642 					ldy #@VarDataSize-1
  1643 					jmp @FreeMem
  1644 					els
  1645 A5F4 60				rts						; ret
  1646 					eif
  1647 				.endl
  1648
  1649 A5F5			.local	UPDATE_SNAKE					; PROCEDURE | REGISTER
  1650 A5F5 85 08			sta S
  1651
  1652 				; optimize OK (game.inc), line = 236
  1653
  1654 A5F7 29 3F			and #$3F
  1655 A5F9 8D 05 AA			sta @CASETMP_0009
  1656 A5FC C9 01			cmp #$01
  1657 A5FE D0 07			jne l_0456
  1658 				@
  1659
  1660 				; optimize OK (game.inc), line = 237
  1661
  1662 A600 A9 4F			lda #$4F
  1663 A602 85 8C			sta SNAKE.BODY
  1664
  1665 A604 4C 3B A6			jmp a_0009
  1666 A607			l_0456
  1667 A607 C9 02			cmp #$02
  1668 A609 D0 07			jne l_0463
  1669 				@
  1670
  1671 				; optimize OK (game.inc), line = 238
  1672
  1673 A60B A9 4E			lda #$4E
  1674 A60D 85 8C			sta SNAKE.BODY
  1675
  1676 A60F 4C 3B A6			jmp a_0009
  1677 A612			l_0463
  1678 A612 C9 04			cmp #$04
  1679 A614 D0 07			jne l_0470
  1680 				@
  1681
  1682 				; optimize OK (game.inc), line = 239
  1683
  1684 A616 A9 51			lda #$51
  1685 A618 85 8C			sta SNAKE.BODY
  1686
  1687 A61A 4C 3B A6			jmp a_0009
  1688 A61D			l_0470
  1689 A61D C9 08			cmp #$08
  1690 A61F D0 07			jne l_047D
  1691 				@
  1692
  1693 				; optimize OK (game.inc), line = 240
  1694
  1695 A621 A9 50			lda #$50
  1696 A623 85 8C			sta SNAKE.BODY
  1697
  1698 A625 4C 3B A6			jmp a_0009
  1699 A628			l_047D
  1700 A628 C9 10			cmp #$10
  1701 A62A D0 07			jne l_048A
  1702 				@
  1703
  1704 				; optimize OK (game.inc), line = 241
  1705
  1706 A62C A9 4C			lda #$4C
  1707 A62E 85 8C			sta SNAKE.BODY
  1708
  1709 A630 4C 3B A6			jmp a_0009
  1710 A633			l_048A
  1711 A633 C9 20			cmp #$20
  1712 A635 D0 04			jne l_0497
  1713 				@
  1714
  1715 				; optimize OK (game.inc), line = 242
  1716
  1717 A637 A9 4D			lda #$4D
  1718 A639 85 8C			sta SNAKE.BODY
  1719
  1720 A63B			l_0497
  1721 A63B			a_0009
  1722
  1723 				; optimize OK (game.inc), line = 245
  1724
  1725 A63B A5 08			lda S
  1726 A63D 29 C0			and #$C0
  1727 A63F 8D 06 AA			sta @CASETMP_000A
  1728 A642 C9 00			cmp #$00
  1729 A644 D0 0B			jne l_04B4
  1730 				@
  1731
  1732 				; optimize OK (game.inc), line = 246
  1733
  1734 A646 A9 48			lda #$48
  1735 A648 85 8B			sta SNAKE.HEAD
  1736 A64A A9 E7			lda #$E7
  1737 A64C 85 8D			sta SNAKE.M
  1738
  1739 A64E 4C 7B A6			jmp a_000A
  1740 A651			l_04B4
  1741 A651 C9 40			cmp #$40
  1742 A653 D0 0B			jne l_04C5
  1743 				@
  1744
  1745 				; optimize OK (game.inc), line = 247
  1746
  1747 A655 A9 49			lda #$49
  1748 A657 85 8B			sta SNAKE.HEAD
  1749 A659 A9 19			lda #$19
  1750 A65B 85 8D			sta SNAKE.M
  1751
  1752 A65D 4C 7B A6			jmp a_000A
  1753 A660			l_04C5
  1754 A660 C9 80			cmp #$80
  1755 A662 D0 0B			jne l_04D6
  1756 				@
  1757
  1758 				; optimize OK (game.inc), line = 248
  1759
  1760 A664 A9 4B			lda #$4B
  1761 A666 85 8B			sta SNAKE.HEAD
  1762 A668 A9 01			lda #$01
  1763 A66A 85 8D			sta SNAKE.M
  1764
  1765 A66C 4C 7B A6			jmp a_000A
  1766 A66F			l_04D6
  1767 A66F C9 C0			cmp #$C0
  1768 A671 D0 08			jne l_04E7
  1769 				@
  1770
  1771 				; optimize OK (game.inc), line = 249
  1772
  1773 A673 A9 4A			lda #$4A
  1774 A675 85 8B			sta SNAKE.HEAD
  1775 A677 A9 FF			lda #$FF
  1776 A679 85 8D			sta SNAKE.M
  1777
  1778 A67B			l_04E7
  1779 A67B			a_000A
  1780
  1781 				; optimize OK (game.inc), line = 252
  1782
  1783 A67B A0 00			ldy #$00
  1784 A67D A5 8D			lda SNAKE.M
  1785 A67F 10 01			spl
  1786 A681 88				dey
  1787 A682 18 65 84			add HEAD_POS
  1788 A685 85 73			sta T0W
  1789 A687 98				tya
  1790 A688 65 85			adc HEAD_POS+1
  1791 A68A 85 74			sta T0W+1
  1792
  1793 				; optimize OK (game.inc), line = 253
  1794
  1795 A68C 85 01			sta :bp+1
  1796 A68E A4 73			ldy T0W
  1797 A690 B1 00			lda (:bp),y
  1798 A692 85 75			sta T1W
  1799 A694 A9 00			lda #$00
  1800 A696 85 76			sta T1W+1
  1801
  1802 				; optimize OK (game.inc), line = 255
  1803
  1804 A698 D0 04			bne @+
  1805 A69A A5 75			lda T1W
  1806 A69C C9 20			cmp #$20
  1807 				@
  1808 A69E F0 0D			jeq l_0524x
  1809 A6A0 A5 76			lda T1W+1
  1810 A6A2 D0 04			bne @+
  1811 A6A4 A5 75			lda T1W
  1812 A6A6 C9 40			cmp #$40
  1813 				@
  1814 A6A8 F0 03 4C 33 A7		jne l_0524
  1815 A6AD			l_0524x
  1816
  1817 				; optimize OK (game.inc), line = 257
  1818
  1819 A6AD A5 76			lda T1W+1
  1820 A6AF D0 04			bne @+
  1821 A6B1 A5 75			lda T1W
  1822 A6B3 C9 40			cmp #$40
  1823 				@
  1824 A6B5 D0 3F			jne l_0536
  1825
  1826 				; optimize OK (game.inc), line = 258
  1827
  1828 A6B7 A9 00			lda #$00
  1829 A6B9 85 8A			sta FRUIT_ON_BOARD
  1830
  1831 				; optimize OK (game.inc), line = 260
  1832
  1833 A6BB A9 10			lda #$10
  1834 A6BD 85 08			sta SYS_VIC20.UPDATE_COUNTER_4.V
  1835 A6BF A9 80			lda #$80
  1836 A6C1 85 0C			sta SYS_VIC20.UPDATE_COUNTER_4.COUNTER
  1837 A6C3 A9 00			lda #$00
  1838 A6C5 85 0D			sta SYS_VIC20.UPDATE_COUNTER_4.COUNTER+1
  1839 A6C7 A9 EA			lda #$EA
  1840 A6C9 85 04			sta SYS_VIC20.UPDATE_COUNTER_4.SCR_COUNTER
  1841 A6CB A9 1E			lda #$1E
  1842 A6CD 85 05			sta SYS_VIC20.UPDATE_COUNTER_4.SCR_COUNTER+1
  1843 A6CF 20 80 A2			jsr SYS_VIC20.UPDATE_COUNTER_4
  1844
  1845 				; optimize FAIL (0, game.inc), line = 262
  1846
  1847 A6D2 C6 7B			dec LEVEL_UP
  1848
  1849 				; optimize OK (game.inc), line = 263
  1850
  1851 A6D4 D0 1D			jne l_0555
  1852
  1853 				; optimize FAIL (0, game.inc), line = 264
  1854
  1855 A6D6 E6 7F			inc LEVEL
  1856
  1857 				; optimize OK (game.inc), line = 265
  1858
  1859 A6D8 A9 01			lda #$01
  1860 A6DA 85 08			sta SYS_VIC20.UPDATE_COUNTER_2.V
  1861 A6DC A9 7E			lda #$7E
  1862 A6DE 85 0C			sta SYS_VIC20.UPDATE_COUNTER_2.COUNTER
  1863 A6E0 A9 00			lda #$00
  1864 A6E2 85 0D			sta SYS_VIC20.UPDATE_COUNTER_2.COUNTER+1
  1865 A6E4 A9 D9			lda #$D9
  1866 A6E6 85 04			sta SYS_VIC20.UPDATE_COUNTER_2.SCR_COUNTER
  1867 A6E8 A9 1E			lda #$1E
  1868 A6EA 85 05			sta SYS_VIC20.UPDATE_COUNTER_2.SCR_COUNTER+1
  1869 A6EC 20 5D A2			jsr SYS_VIC20.UPDATE_COUNTER_2
  1870
  1871 				; optimize OK (game.inc), line = 266
  1872
  1873 A6EF A9 0A			lda #$0A
  1874 A6F1 85 7B			sta LEVEL_UP
  1875 A6F3			l_0555
  1876 A6F3 4C F9 A6			jmp l_056D
  1877 A6F6			l_0536
  1878
  1879 				; optimize FAIL ('MOVE_TAIL', game.inc), line = 270
  1880
  1881 A6F6 20 EA A4			jsr MOVE_TAIL
  1882 A6F9			l_056D
  1883
  1884 				; optimize OK (game.inc), line = 272
  1885
  1886 A6F9 A4 85			ldy HEAD_POS+1
  1887 A6FB 84 01			sty :bp+1
  1888 A6FD A4 84			ldy HEAD_POS
  1889 A6FF A5 8C			lda SNAKE.BODY
  1890 A701 91 00			sta (:bp),y
  1891
  1892 				; optimize OK (game.inc), line = 274
  1893
  1894 A703 A0 00			ldy #$00
  1895 A705 A5 8D			lda SNAKE.M
  1896 A707 10 01			spl
  1897 A709 88				dey
  1898 A70A 18 65 86			add HEAD_POS_COL
  1899 A70D 85 86			sta HEAD_POS_COL
  1900 A70F 98				tya
  1901 A710 65 87			adc HEAD_POS_COL+1
  1902 A712 85 87			sta HEAD_POS_COL+1
  1903
  1904 				; optimize OK (game.inc), line = 275
  1905
  1906 A714 A4 74			ldy T0W+1
  1907 A716 84 01			sty :bp+1
  1908 A718 A4 73			ldy T0W
  1909 A71A A5 8B			lda SNAKE.HEAD
  1910 A71C 91 00			sta (:bp),y
  1911
  1912 				; optimize OK (game.inc), line = 276
  1913
  1914 A71E A4 87			ldy HEAD_POS_COL+1
  1915 A720 84 01			sty :bp+1
  1916 A722 A4 86			ldy HEAD_POS_COL
  1917 A724 A9 01			lda #$01
  1918 A726 91 00			sta (:bp),y
  1919
  1920 				; optimize OK (game.inc), line = 277
  1921
  1922 A728 A5 73			lda T0W
  1923 A72A 85 84			sta HEAD_POS
  1924 A72C A5 74			lda T0W+1
  1925 A72E 85 85			sta HEAD_POS+1
  1926 A730 4C 37 A7			jmp l_0597
  1927 A733			l_0524
  1928
  1929 				; optimize OK (game.inc), line = 280
  1930
  1931 A733 A9 01			lda #$01
  1932 A735 85 FB			sta GAME_OVER
  1933 A737			l_0597
  1934
  1935 				; ------------------------------------------------------------
  1936
  1937 = 0008			S	= :EDX
  1938 = AA05			@CASETMP_0009	= DATAORIGIN+$0009
  1939 = AA06			@CASETMP_000A	= DATAORIGIN+$000A
  1940
  1941 = AA05			@VarData	= @CASETMP_0009
  1942 = 0002			@VarDataSize	= 2
  1943
  1944 A737			@exit
  1945 					.ifdef @new
  1946 					lda <@VarData
  1947 					sta :ztmp
  1948 					lda >@VarData
  1949 					ldy #@VarDataSize-1
  1950 					jmp @FreeMem
  1951 					els
  1952 A737 60				rts						; ret
  1953 					eif
  1954 				.endl
  1955
  1956 A738			.local	MOVE_SNAKE					; PROCEDURE
  1957
  1958 				; optimize OK (game.inc), line = 286
  1959
  1960 A738 A5 7A			lda HEAD_DIR
  1961 A73A 8D 07 AA			sta @CASETMP_000B
  1962 A73D C9 44			cmp #$44
  1963 A73F D0 07			jne l_05AA
  1964 				@
  1965
  1966 				; optimize OK (game.inc), line = 287
  1967
  1968 A741 A9 10			lda #$10
  1969 A743 85 70			sta T0B
  1970
  1971 A745 4C 66 A7			jmp a_000B
  1972 A748			l_05AA
  1973 A748 C9 45			cmp #$45
  1974 A74A D0 07			jne l_05B7
  1975 				@
  1976
  1977 				; optimize OK (game.inc), line = 288
  1978
  1979 A74C A9 50			lda #$50
  1980 A74E 85 70			sta T0B
  1981
  1982 A750 4C 66 A7			jmp a_000B
  1983 A753			l_05B7
  1984 A753 C9 46			cmp #$46
  1985 A755 D0 07			jne l_05C4
  1986 				@
  1987
  1988 				; optimize OK (game.inc), line = 289
  1989
  1990 A757 A9 A0			lda #$A0
  1991 A759 85 70			sta T0B
  1992
  1993 A75B 4C 66 A7			jmp a_000B
  1994 A75E			l_05C4
  1995 A75E C9 47			cmp #$47
  1996 A760 D0 04			jne l_05D1
  1997 				@
  1998
  1999 				; optimize OK (game.inc), line = 290
  2000
  2001 A762 A9 E0			lda #$E0
  2002 A764 85 70			sta T0B
  2003
  2004 A766			l_05D1
  2005 A766			a_000B
  2006
  2007 				; optimize OK (game.inc), line = 293
  2008
  2009 A766 A5 70			lda T0B
  2010 A768 20 F5 A5			jsr UPDATE_SNAKE
  2011
  2012 				; ------------------------------------------------------------
  2013
  2014 = AA07			@CASETMP_000B	= DATAORIGIN+$000B
  2015
  2016 = AA07			@VarData	= @CASETMP_000B
  2017 = 0001			@VarDataSize	= 1
  2018
  2019 A76B			@exit
  2020 					.ifdef @new
  2021 					lda <@VarData
  2022 					sta :ztmp
  2023 					lda >@VarData
  2024 					ldy #@VarDataSize-1
  2025 					jmp @FreeMem
  2026 					els
  2027 A76B 60				rts						; ret
  2028 					eif
  2029 				.endl
  2030
  2031 A76C			.local	JOY_HANDLER					; PROCEDURE
  2032
  2033 				; optimize OK (game.inc), line = 300
  2034
  2035 A76C A9 00			lda #$00
  2036 A76E 85 70			sta T0B
  2037
  2038 				; optimize OK (game.inc), line = 302
  2039
  2040 A770 A5 61			lda SYS_VIC20.JOY
  2041 A772 29 04			and #$04
  2042 A774 F0 23			jeq l_060B
  2043 A776 A5 7A			lda HEAD_DIR
  2044 A778 C9 45			cmp #$45
  2045 A77A F0 1D			jeq l_060B
  2046
  2047 				; optimize OK (game.inc), line = 303
  2048
  2049 A77C 8D 08 AA			sta @CASETMP_000C
  2050 A77F C9 47			cmp #$47
  2051 A781 D0 07			jne l_0617
  2052 				@
  2053
  2054 				; optimize OK (game.inc), line = 304
  2055
  2056 A783 A9 01			lda #$01
  2057 A785 85 70			sta T0B
  2058
  2059 A787 4C 92 A7			jmp a_000C
  2060 A78A			l_0617
  2061 A78A C9 46			cmp #$46
  2062 A78C D0 04			jne l_0624
  2063 				@
  2064
  2065 				; optimize OK (game.inc), line = 305
  2066
  2067 A78E A9 02			lda #$02
  2068 A790 85 70			sta T0B
  2069
  2070 A792			l_0624
  2071 A792			a_000C
  2072
  2073 				; optimize OK (game.inc), line = 307
  2074
  2075 A792 A9 44			lda #$44
  2076 A794 85 7A			sta HEAD_DIR
  2077 A796 4C 0F A8			jmp l_063B
  2078 A799			l_060B
  2079
  2080 				; optimize OK (game.inc), line = 309
  2081
  2082 A799 A5 61			lda SYS_VIC20.JOY
  2083 A79B 29 08			and #$08
  2084 A79D F0 23			jeq l_065D
  2085 A79F A5 7A			lda HEAD_DIR
  2086 A7A1 C9 44			cmp #$44
  2087 A7A3 F0 1D			jeq l_065D
  2088
  2089 				; optimize OK (game.inc), line = 310
  2090
  2091 A7A5 8D 09 AA			sta @CASETMP_000D
  2092 A7A8 C9 47			cmp #$47
  2093 A7AA D0 07			jne l_0669
  2094 				@
  2095
  2096 				; optimize OK (game.inc), line = 311
  2097
  2098 A7AC A9 44			lda #$44
  2099 A7AE 85 70			sta T0B
  2100
  2101 A7B0 4C BB A7			jmp a_000D
  2102 A7B3			l_0669
  2103 A7B3 C9 46			cmp #$46
  2104 A7B5 D0 04			jne l_0676
  2105 				@
  2106
  2107 				; optimize OK (game.inc), line = 312
  2108
  2109 A7B7 A9 48			lda #$48
  2110 A7B9 85 70			sta T0B
  2111
  2112 A7BB			l_0676
  2113 A7BB			a_000D
  2114
  2115 				; optimize OK (game.inc), line = 314
  2116
  2117 A7BB A9 45			lda #$45
  2118 A7BD 85 7A			sta HEAD_DIR
  2119 A7BF 4C 0F A8			jmp l_068D
  2120 A7C2			l_065D
  2121
  2122 				; optimize OK (game.inc), line = 316
  2123
  2124 A7C2 A5 61			lda SYS_VIC20.JOY
  2125 A7C4 10 23			jpl l_06AF
  2126 A7C6 A5 7A			lda HEAD_DIR
  2127 A7C8 C9 47			cmp #$47
  2128 A7CA F0 1D			jeq l_06AF
  2129
  2130 				; optimize OK (game.inc), line = 317
  2131
  2132 A7CC 8D 0A AA			sta @CASETMP_000E
  2133 A7CF C9 44			cmp #$44
  2134 A7D1 D0 07			jne l_06BB
  2135 				@
  2136
  2137 				; optimize OK (game.inc), line = 318
  2138
  2139 A7D3 A9 84			lda #$84
  2140 A7D5 85 70			sta T0B
  2141
  2142 A7D7 4C E2 A7			jmp a_000E
  2143 A7DA			l_06BB
  2144 A7DA C9 45			cmp #$45
  2145 A7DC D0 04			jne l_06C8
  2146 				@
  2147
  2148 				; optimize OK (game.inc), line = 319
  2149
  2150 A7DE A9 81			lda #$81
  2151 A7E0 85 70			sta T0B
  2152
  2153 A7E2			l_06C8
  2154 A7E2			a_000E
  2155
  2156 				; optimize OK (game.inc), line = 321
  2157
  2158 A7E2 A9 46			lda #$46
  2159 A7E4 85 7A			sta HEAD_DIR
  2160 A7E6 4C 0F A8			jmp l_06DF
  2161 A7E9			l_06AF
  2162
  2163 				; optimize OK (game.inc), line = 323
  2164
  2165 A7E9 A5 61			lda SYS_VIC20.JOY
  2166 A7EB 29 10			and #$10
  2167 A7ED F0 20			jeq l_0701
  2168 A7EF A5 7A			lda HEAD_DIR
  2169 A7F1 C9 46			cmp #$46
  2170 A7F3 F0 1A			jeq l_0701
  2171
  2172 				; optimize OK (game.inc), line = 324
  2173
  2174 A7F5 8D 0B AA			sta @CASETMP_000F
  2175 A7F8 C9 44			cmp #$44
  2176 A7FA D0 07			jne l_070D
  2177 				@
  2178
  2179 				; optimize OK (game.inc), line = 325
  2180
  2181 A7FC A9 C8			lda #$C8
  2182 A7FE 85 70			sta T0B
  2183
  2184 A800 4C 0B A8			jmp a_000F
  2185 A803			l_070D
  2186 A803 C9 45			cmp #$45
  2187 A805 D0 04			jne l_071A
  2188 				@
  2189
  2190 				; optimize OK (game.inc), line = 326
  2191
  2192 A807 A9 C2			lda #$C2
  2193 A809 85 70			sta T0B
  2194
  2195 A80B			l_071A
  2196 A80B			a_000F
  2197
  2198 				; optimize OK (game.inc), line = 328
  2199
  2200 A80B A9 47			lda #$47
  2201 A80D 85 7A			sta HEAD_DIR
  2202 A80F			l_0701
  2203 A80F			l_06DF
  2204 A80F			l_068D
  2205 A80F			l_063B
  2206
  2207 				; optimize OK (game.inc), line = 330
  2208
  2209 A80F A5 61			lda SYS_VIC20.JOY
  2210 A811 29 20			and #$20
  2211 A813 F0 06			jeq l_0740
  2212 A815 A5 77			lda SNAKE_SPEED
  2213 A817 4A				lsr @
  2214 A818 4A				lsr @
  2215 A819 85 77			sta SNAKE_SPEED
  2216 A81B			l_0740
  2217
  2218 				; optimize OK (game.inc), line = 332
  2219
  2220 A81B A5 70			lda T0B
  2221 A81D F0 09			jeq l_075F
  2222
  2223 				; optimize OK (game.inc), line = 333
  2224
  2225 A81F A5 77			lda SNAKE_SPEED
  2226 A821 85 78			sta SNAKE_SPD_C
  2227
  2228 				; optimize OK (game.inc), line = 334
  2229
  2230 A823 A5 70			lda T0B
  2231 A825 20 F5 A5			jsr UPDATE_SNAKE
  2232 A828			l_075F
  2233
  2234 				; ------------------------------------------------------------
  2235
  2236 = AA08			@CASETMP_000C	= DATAORIGIN+$000C
  2237 = AA09			@CASETMP_000D	= DATAORIGIN+$000D
  2238 = AA0A			@CASETMP_000E	= DATAORIGIN+$000E
  2239 = AA0B			@CASETMP_000F	= DATAORIGIN+$000F
  2240
  2241 = AA08			@VarData	= @CASETMP_000C
  2242 = 0004			@VarDataSize	= 4
  2243
  2244 A828			@exit
  2245 					.ifdef @new
  2246 					lda <@VarData
  2247 					sta :ztmp
  2248 					lda >@VarData
  2249 					ldy #@VarDataSize-1
  2250 					jmp @FreeMem
  2251 					els
  2252 A828 60				rts						; ret
  2253 					eif
  2254 				.endl
  2255
  2256 A829			.local	PUT_FRUIT					; PROCEDURE
  2257
  2258 				; optimize OK (game.inc), line = 342
  2259
  2260 A829 A9 01			lda #$01
  2261 A82B 85 08			sta SYS_VIC20.PRND_0113.A
  2262 A82D A9 18			lda #$18
  2263 A82F 85 0C			sta SYS_VIC20.PRND_0113.B
  2264 A831 A9 1F			lda #$1F
  2265 A833 85 04			sta SYS_VIC20.PRND_0113.MASK
  2266 A835 20 D5 A2			jsr SYS_VIC20.PRND_0113
  2267 A838 A5 62			lda SYS_VIC20.RND
  2268 A83A 85 70			sta T0B
  2269
  2270 				; optimize OK (game.inc), line = 343
  2271
  2272 A83C A9 01			lda #$01
  2273 A83E 85 08			sta SYS_VIC20.PRND_0113.A
  2274 A840 A9 1B			lda #$1B
  2275 A842 85 0C			sta SYS_VIC20.PRND_0113.B
  2276 A844 A9 1F			lda #$1F
  2277 A846 85 04			sta SYS_VIC20.PRND_0113.MASK
  2278 A848 20 D5 A2			jsr SYS_VIC20.PRND_0113
  2279 A84B A5 62			lda SYS_VIC20.RND
  2280 A84D 85 71			sta T1B
  2281
  2282 				; optimize OK (game.inc), line = 345
  2283
  2284 A84F 85 0C			sta :ecx
  2285 A851 A9 19			lda #$19
  2286 A853 85 04			sta :eax
  2287 					.ifdef fmulinit
  2288 					fmulu_8
  2289 					els
  2290 A855 20 FC A0			imulCL
  2291 					eif
  2292 A858 A5 04			lda :eax
  2293 A85A 85 73			sta T0W
  2294 A85C A5 05			lda :eax+1
  2295 A85E 85 74			sta T0W+1
  2296 A860 18 69 1C			add #$1C
  2297 A863 85 74			sta T0W+1
  2298 A865 A5 73			lda T0W
  2299 A867 18 65 70			add T0B
  2300 A86A 85 73			sta T0W
  2301 A86C 90 02			scc
  2302 A86E E6 74			inc T0W+1
  2303
  2304 				; optimize OK (game.inc), line = 347
  2305
  2306 A870 A4 74			ldy T0W+1
  2307 A872 84 01			sty :bp+1
  2308 A874 A4 73			ldy T0W
  2309 A876 B1 00			lda (:bp),y
  2310 A878 C9 20			cmp #$20
  2311 A87A D0 1A			jne l_07A4
  2312
  2313 				; optimize OK (game.inc), line = 348
  2314
  2315 A87C A5 70			lda T0B
  2316 A87E 85 08			sta SYS_VIC20.SET_XY.X
  2317 A880 A5 71			lda T1B
  2318 A882 85 0C			sta SYS_VIC20.SET_XY.Y
  2319 A884 20 01 A2			jsr SYS_VIC20.SET_XY
  2320 A887 A9 05			lda #$05
  2321 A889 85 08			sta SYS_VIC20.PUT_CHAR.COL
  2322 A88B A9 40			lda #$40
  2323 A88D 85 0C			sta SYS_VIC20.PUT_CHAR.C
  2324 A88F 20 52 A2			jsr SYS_VIC20.PUT_CHAR
  2325
  2326 				; optimize OK (game.inc), line = 349
  2327
  2328 A892 A9 01			lda #$01
  2329 A894 85 8A			sta FRUIT_ON_BOARD
  2330 A896			l_07A4
  2331 A896			@exit
  2332 					.ifdef @new
  2333 					lda <@VarData
  2334 					sta :ztmp
  2335 					lda >@VarData
  2336 					ldy #@VarDataSize-1
  2337 					jmp @FreeMem
  2338 					els
  2339 A896 60				rts						; ret
  2340 					eif
  2341 				.endl
  2342
  2343 A897			.local	UPDATE_TIME					; PROCEDURE
  2344
  2345 				; optimize FAIL (0, game.inc), line = 357
  2346
  2347 A897 C6 7C			dec TIME_ENTITY
  2348
  2349 				; optimize OK (game.inc), line = 358
  2350
  2351 A899 D0 1B			jne l_07CF
  2352
  2353 				; optimize OK (game.inc), line = 359
  2354
  2355 A89B A9 C8			lda #$C8
  2356 A89D 85 7C			sta TIME_ENTITY
  2357
  2358 				; optimize OK (game.inc), line = 360
  2359
  2360 A89F A9 01			lda #$01
  2361 A8A1 85 08			sta SYS_VIC20.UPDATE_COUNTER_2.V
  2362 A8A3 A9 7D			lda #$7D
  2363 A8A5 85 0C			sta SYS_VIC20.UPDATE_COUNTER_2.COUNTER
  2364 A8A7 A9 00			lda #$00
  2365 A8A9 85 0D			sta SYS_VIC20.UPDATE_COUNTER_2.COUNTER+1
  2366 A8AB A9 DE			lda #$DE
  2367 A8AD 85 04			sta SYS_VIC20.UPDATE_COUNTER_2.SCR_COUNTER
  2368 A8AF A9 1E			lda #$1E
  2369 A8B1 85 05			sta SYS_VIC20.UPDATE_COUNTER_2.SCR_COUNTER+1
  2370 A8B3 20 5D A2			jsr SYS_VIC20.UPDATE_COUNTER_2
  2371 A8B6			l_07CF
  2372 A8B6			@exit
  2373 					.ifdef @new
  2374 					lda <@VarData
  2375 					sta :ztmp
  2376 					lda >@VarData
  2377 					ldy #@VarDataSize-1
  2378 					jmp @FreeMem
  2379 					els
  2380 A8B6 60				rts						; ret
  2381 					eif
  2382 				.endl
  2383
  2384 A8B7			.local	SNAKE_STEP					; PROCEDURE
  2385
  2386 				; optimize OK (game.inc), line = 368
  2387
  2388 A8B7 A9 0E			lda #$0E
  2389 A8B9 38 E5 7F			sub LEVEL
  2390 A8BC 85 77			sta SNAKE_SPEED
  2391
  2392 				; optimize OK (game.inc), line = 369
  2393
  2394 A8BE C9 02			cmp #$02
  2395 A8C0 B0 04			jcs l_07FA
  2396 A8C2 A9 02			lda #$02
  2397 A8C4 85 77			sta SNAKE_SPEED
  2398 A8C6			l_07FA
  2399
  2400 				; optimize FAIL ('JOY_HANDLER', game.inc), line = 371
  2401
  2402 A8C6 20 6C A7			jsr JOY_HANDLER
  2403
  2404 				; optimize OK (game.inc), line = 373
  2405
  2406 A8C9 A5 78			lda SNAKE_SPD_C
  2407 A8CB D0 0A			jne l_0814
  2408
  2409 				; optimize FAIL ('MOVE_SNAKE', game.inc), line = 374
  2410
  2411 A8CD 20 38 A7			jsr MOVE_SNAKE
  2412
  2413 				; optimize OK (game.inc), line = 375
  2414
  2415 A8D0 A5 77			lda SNAKE_SPEED
  2416 A8D2 85 78			sta SNAKE_SPD_C
  2417 A8D4 4C D9 A8			jmp l_0825
  2418 A8D7			l_0814
  2419
  2420 				; optimize FAIL (0, game.inc), line = 377
  2421
  2422 A8D7 C6 78			dec SNAKE_SPD_C
  2423 A8D9			l_0825
  2424 A8D9			@exit
  2425 					.ifdef @new
  2426 					lda <@VarData
  2427 					sta :ztmp
  2428 					lda >@VarData
  2429 					ldy #@VarDataSize-1
  2430 					jmp @FreeMem
  2431 					els
  2432 A8D9 60				rts						; ret
  2433 					eif
  2434 				.endl
  2435
  2436 A8DA			.local	SET_GAME					; PROCEDURE
  2437
  2438 				; optimize OK (game.inc), line = 384
  2439
  2440 A8DA A9 20			lda #$20
  2441 A8DC 20 DB A1			jsr SYS_VIC20.CLRSCR
  2442 A8DF 20 0D A3			jsr DRAW_FRAME
  2443 A8E2 20 49 A4			jsr DRAW_BOTTOM_LINE
  2444 A8E5 20 AC A3			jsr PUT_SNAKE
  2445 A8E8 20 A0 A4			jsr PRINT_HI_SCORE
  2446
  2447 				; optimize OK (game.inc), line = 386
  2448
  2449 A8EB A9 C8			lda #$C8
  2450 A8ED 85 7C			sta TIME_ENTITY
  2451
  2452 				; optimize OK (game.inc), line = 387
  2453
  2454 A8EF A9 0A			lda #$0A
  2455 A8F1 85 7B			sta LEVEL_UP
  2456
  2457 				; optimize OK (game.inc), line = 388
  2458
  2459 A8F3 A9 00			lda #$00
  2460 A8F5 85 80			sta SCORE_BCD
  2461 A8F7 85 81			sta SCORE_BCD+1
  2462
  2463 				; optimize OK (game.inc), line = 389
  2464
  2465 A8F9 85 7D			sta TIME_BCD
  2466
  2467 				; optimize OK (game.inc), line = 390
  2468
  2469 A8FB 85 7E			sta LEVEL_BCD
  2470
  2471 				; optimize OK (game.inc), line = 391
  2472
  2473 A8FD 85 7F			sta LEVEL
  2474
  2475 				; optimize OK (game.inc), line = 392
  2476
  2477 A8FF 85 78			sta SNAKE_SPD_C
  2478
  2479 				; optimize OK (game.inc), line = 393
  2480
  2481 A901 85 8A			sta FRUIT_ON_BOARD
  2482
  2483 				; optimize OK (game.inc), line = 394
  2484
  2485 A903 85 FB			sta GAME_OVER
  2486
  2487 				; optimize OK (game.inc), line = 396
  2488
  2489 A905 A9 01			lda #$01
  2490 A907 20 CF A1			jsr SYS_VIC20.WAIT_00DC
  2491 A90A			@exit
  2492 					.ifdef @new
  2493 					lda <@VarData
  2494 					sta :ztmp
  2495 					lda >@VarData
  2496 					ldy #@VarDataSize-1
  2497 					jmp @FreeMem
  2498 					els
  2499 A90A 60				rts						; ret
  2500 					eif
  2501 				.endl
  2502
  2503 A90B			.local	RESTART_GAME					; PROCEDURE
  2504
  2505 				; optimize FAIL ('HALL_OF_FAME', game.inc), line = 403
  2506
  2507 A90B 20 D2 A4			jsr HALL_OF_FAME
  2508
  2509 				; optimize OK (game.inc), line = 404
  2510
  2511 A90E A9 19			lda #$19
  2512 A910 20 CF A1			jsr SYS_VIC20.WAIT_00DC
  2513
  2514 				; optimize FAIL ('PRESS_FIRE', game.inc), line = 405
  2515
  2516 A913 20 84 A3			jsr PRESS_FIRE
  2517
  2518 				; optimize FAIL ('SET_GAME', game.inc), line = 406
  2519
  2520 A916 20 DA A8			jsr SET_GAME
  2521 A919			@exit
  2522 					.ifdef @new
  2523 					lda <@VarData
  2524 					sta :ztmp
  2525 					lda >@VarData
  2526 					ldy #@VarDataSize-1
  2527 					jmp @FreeMem
  2528 					els
  2529 A919 60				rts						; ret
  2530 					eif
  2531 				.endl
  2532
  2533 A91A			.local	VBI						; PROCEDURE
  2534
  2535 				; optimize OK (game.inc), line = 413
  2536
  2537 A91A A5 FB			lda GAME_OVER
  2538 A91C D0 17			jne l_0875
  2539
  2540 				; optimize FAIL ('UPDATE_TIME', game.inc), line = 414
  2541
  2542 A91E 20 97 A8			jsr UPDATE_TIME
  2543
  2544 				; optimize FAIL ('SNAKE_STEP', game.inc), line = 415
  2545
  2546 A921 20 B7 A8			jsr SNAKE_STEP
  2547
  2548 				; optimize OK (game.inc), line = 416
  2549
  2550 A924 A5 8A			lda FRUIT_ON_BOARD
  2551 A926 D0 03			jne l_0887
  2552 A928 20 29 A8			jsr PUT_FRUIT
  2553 A92B			l_0887
  2554
  2555 				; optimize OK (game.inc), line = 417
  2556
  2557 A92B A5 7D			lda TIME_BCD
  2558 A92D C9 99			cmp #$99
  2559 A92F D0 04			jne l_089D
  2560 A931 A9 01			lda #$01
  2561 A933 85 FB			sta GAME_OVER
  2562 A935			l_089D
  2563 A935			l_0875
  2564 A935			@exit
  2565 					.ifdef @new
  2566 					lda <@VarData
  2567 					sta :ztmp
  2568 					lda >@VarData
  2569 					ldy #@VarDataSize-1
  2570 					jmp @FreeMem
  2571 					els
  2572 A935 60				rts						; ret
  2573 					eif
  2574 				.endl
  2575
  2576 A936			.local	PREPARE						; PROCEDURE
  2577
  2578 				; optimize OK (game.inc), line = 425
  2579
  2580 A936 A9 00			lda #$00
  2581 A938 85 08			sta SYSTEM.MOVE_00B1.SOURCE
  2582 A93A A9 BC			lda #$BC
  2583 A93C 85 09			sta SYSTEM.MOVE_00B1.SOURCE+1
  2584 A93E A9 00			lda #$00
  2585 A940 85 0C			sta SYSTEM.MOVE_00B1.DEST
  2586 A942 A9 10			lda #$10
  2587 A944 85 0D			sta SYSTEM.MOVE_00B1.DEST+1
  2588 A946 A9 00			lda #$00
  2589 A948 85 04			sta SYSTEM.MOVE_00B1.COUNT
  2590 A94A A9 04			lda #$04
  2591 A94C 85 05			sta SYSTEM.MOVE_00B1.COUNT+1
  2592 A94E				.local +MAIN.SYSTEM.MOVE_00B1
  2593 A94E				m@INLINE
Macro: MAIN.SYSTEM.MOVE_00B1.M@INLINE [Source: vic20.a65]
     4 A94E 20 A7 A0			jsr @move
Source: vic20.a65
  2594 					.endl
  2595
  2596 				; optimize OK (game.inc), line = 426
  2597
  2598 A951 A9 12			lda #$12
  2599 A953 85 08			sta SYSTEM.MOVE_00B1.SOURCE
  2600 A955 A9 B9			lda #$B9
  2601 A957 85 09			sta SYSTEM.MOVE_00B1.SOURCE+1
  2602 A959 A9 00			lda #$00
  2603 A95B 85 0C			sta SYSTEM.MOVE_00B1.DEST
  2604 A95D A9 1C			lda #$1C
  2605 A95F 85 0D			sta SYSTEM.MOVE_00B1.DEST+1
  2606 A961 A9 EE			lda #$EE
  2607 A963 85 04			sta SYSTEM.MOVE_00B1.COUNT
  2608 A965 A9 02			lda #$02
  2609 A967 85 05			sta SYSTEM.MOVE_00B1.COUNT+1
  2610 A969				.local +MAIN.SYSTEM.MOVE_00B1
  2611 A969				m@INLINE
Macro: MAIN.SYSTEM.MOVE_00B1.M@INLINE [Source: vic20.a65]
     4 A969 20 A7 A0			jsr @move
Source: vic20.a65
  2612 					.endl
  2613
  2614 				; optimize FAIL ('VBI', game.inc), line = 432
  2615
  2616 A96C 20 1A A9			jsr VBI
  2617 A96F			@exit
  2618 					.ifdef @new
  2619 					lda <@VarData
  2620 					sta :ztmp
  2621 					lda >@VarData
  2622 					ldy #@VarDataSize-1
  2623 					jmp @FreeMem
  2624 					els
  2625 A96F 60				rts						; ret
  2626 					eif
  2627 				.endl
  2628 A970			l_0067
  2629
  2630 				; optimize OK (game.inc), line = 438
  2631
  2632 A970 A9 01			lda #$01
  2633 A972 85 FB			sta GAME_OVER
  2634
  2635 				; optimize FAIL ('PREPARE', game.inc), line = 440
  2636
  2637 A974 20 36 A9			jsr PREPARE
  2638 A977 20 93 A1			jsr SYS_VIC20.SYS_INIT
  2639 A97A				.local +MAIN.WELCOME_SCR
  2640 A97A				m@INLINE
Macro: MAIN.WELCOME_SCR.M@INLINE [Source: vic20.a65]
     4 A97A A9 01			lda #$01
     5 A97C 20 EE A1			jsr SYS_VIC20.CLRCOL
     9 A97F A9 0C			lda #$0C
    10 A981 85 70			sta T0B
    11 A983 85 72			sta T2B
    15 A985 AD 53 A0			lda adr.TXT_INFO
    16 A988 4A				lsr @
    17 A989 85 71			sta T1B
    18 A98B A5 70			lda T0B
    19 A98D 38 E5 71			sub T1B
    20 A990 85 70			sta T0B
    24 A992 85 08			sta SYS_VIC20.SET_XY.X
    25 A994 A9 02			lda #$02
    26 A996 85 0C			sta SYS_VIC20.SET_XY.Y
    27 A998 20 01 A2			jsr SYS_VIC20.SET_XY
    31 A99B A9 07			lda #$07
    32 A99D 85 08			sta SYS_VIC20.PRINT.COL
    33 A99F A9 53			lda #$53
    34 A9A1 85 0C			sta SYS_VIC20.PRINT.S
    35 A9A3 A9 A0			lda #$A0
    36 A9A5 85 0D			sta SYS_VIC20.PRINT.S+1
    37 A9A7 20 3C A2			jsr SYS_VIC20.PRINT
    41 A9AA AD 3E A0			lda adr.TXT_TURBO
    42 A9AD 4A				lsr @
    43 A9AE 85 71			sta T1B
    44 A9B0 A5 72			lda T2B
    45 A9B2 38 E5 71			sub T1B
    46 A9B5 85 72			sta T2B
    50 A9B7 85 08			sta SYS_VIC20.SET_XY.X
    51 A9B9 A9 19			lda #$19
    52 A9BB 85 0C			sta SYS_VIC20.SET_XY.Y
    53 A9BD 20 01 A2			jsr SYS_VIC20.SET_XY
    57 A9C0 A9 07			lda #$07
    58 A9C2 85 08			sta SYS_VIC20.PRINT.COL
    59 A9C4 A9 3E			lda #$3E
    60 A9C6 85 0C			sta SYS_VIC20.PRINT.S
    61 A9C8 A9 A0			lda #$A0
    62 A9CA 85 0D			sta SYS_VIC20.PRINT.S+1
    63 A9CC 20 3C A2			jsr SYS_VIC20.PRINT
    66 A9CF			l_01AF
    70 A9CF A5 61			lda SYS_VIC20.JOY
    71 A9D1 29 20			and #$20
    72 A9D3 F0 FA			jeq l_01AF
Source: vic20.a65
  2641 					.endl
  2642
  2643 				; optimize OK (game.inc), line = 442
  2644
  2645 A9D5 A9 00			lda #$00
  2646 A9D7 85 82			sta HI_SCORE_BCD
  2647 A9D9 85 83			sta HI_SCORE_BCD+1
  2648 A9DB 20 DA A8			jsr SET_GAME
  2649
  2650 				; --- RepeatUntilProlog
  2651 A9DE			l_08C1
  2652
  2653 				; optimize OK (game.inc), line = 445
  2654
  2655 A9DE A5 FB			lda GAME_OVER
  2656 A9E0 F0 03			jeq l_08CD
  2657 A9E2 20 0B A9			jsr RESTART_GAME
  2658 A9E5			l_08CD
  2659
  2660 				; optimize OK (game.inc), line = 446
  2661
  2662 A9E5 4C DE A9			jmp l_08C1
  2663
  2664 				; ------------------------------------------------------------
  2665
  2666 = BC00			CRT_CHARS_ADR	= $BC00
  2667 = B912			CRT_TITLE_ADR	= $B912
  2668 = 0000			GAME_BLACK	= $00
  2669 = 0001			GAME_WHITE	= $01
  2670 = 0002			GAME_RED	= $02
  2671 = 0003			GAME_CYAN	= $03
  2672 = 0004			GAME_PURPLE	= $04
  2673 = 0005			GAME_GREEN	= $05
  2674 = 0006			GAME_BLUE	= $06
  2675 = 0007			GAME_YELLOW	= $07
  2676 = 0008			GAME_ORANGE	= $08
  2677 = 0020			C_SPACE	= $20
  2678 = 0040			C_FRUIT	= $40
  2679 = 0041			C_WALL_H	= $41
  2680 = 0042			C_WALL_VE	= $42
  2681 = 0043			C_WALL_VW	= $43
  2682 = 0044			C_TAIL_UP	= $44
  2683 = 0045			C_TAIL_DOWN	= $45
  2684 = 0046			C_TAIL_RIGHT	= $46
  2685 = 0047			C_TAIL_LEFT	= $47
  2686 = 0048			C_HEAD_UP	= $48
  2687 = 0049			C_HEAD_DOWN	= $49
  2688 = 004A			C_HEAD_LEFT	= $4A
  2689 = 004B			C_HEAD_RIGHT	= $4B
  2690 = 004C			C_BODY_V	= $4C
  2691 = 004D			C_BODY_H	= $4D
  2692 = 004E			C_BODY_SW	= $4E
  2693 = 004F			C_BODY_SE	= $4F
  2694 = 0050			C_BODY_NW	= $50
  2695 = 0051			C_BODY_NE	= $51
  2696 = A00C			adr.TXT_LEVEL	= CODEORIGIN+$0000
  2697 A9E8			.var TXT_LEVEL	= adr.TXT_LEVEL .word
  2698 = A016			adr.TXT_POINTS	= CODEORIGIN+$000A
  2699 A9E8			.var TXT_POINTS	= adr.TXT_POINTS .word
  2700 = A023			adr.TXT_TIME	= CODEORIGIN+$0017
  2701 A9E8			.var TXT_TIME	= adr.TXT_TIME .word
  2702 = A029			adr.TXT_HSCORE	= CODEORIGIN+$001D
  2703 A9E8			.var TXT_HSCORE	= adr.TXT_HSCORE .word
  2704 = A032			adr.TXT_FIRE	= CODEORIGIN+$0026
  2705 A9E8			.var TXT_FIRE	= adr.TXT_FIRE .word
  2706 = A03E			adr.TXT_TURBO	= CODEORIGIN+$0032
  2707 A9E8			.var TXT_TURBO	= adr.TXT_TURBO .word
  2708 = A053			adr.TXT_INFO	= CODEORIGIN+$0047
  2709 A9E8			.var TXT_INFO	= adr.TXT_INFO .word
  2710 = 0002			SNAKE_SIZE	= $02
  2711 = 000E			GAME_SPEED	= $0E
  2712 = 000A			LEVEL_THOLD	= $0A
  2713 = 0002			SPEED_THOLD	= $02
  2714 = 00C8			TIME_E_SET	= $C8
  2715 = 0099			TIME_THOLD	= $99
  2716 = 0044			UP	= $44
  2717 = 0045			DOWN	= $45
  2718 = 0047			LEFT	= $47
  2719 = 0046			RIGHT	= $46
  2720 = 00E7			MOVE_UP	= $E7
  2721 = 0019			MOVE_DOWN	= $19
  2722 = 00FF			MOVE_LEFT	= $FF
  2723 = 0001			MOVE_RIGHT	= $01
  2724 = 0070			T0B	= $70
  2725 = 0071			T1B	= $71
  2726 = 0072			T2B	= $72
  2727 = 0073			T0W	= $73
  2728 = 0075			T1W	= $75
  2729 = 0077			SNAKE_SPEED	= $77
  2730 = 0078			SNAKE_SPD_C	= $78
  2731 = 0079			TAIL_DIR	= $79
  2732 = 007A			HEAD_DIR	= $7A
  2733 = 007B			LEVEL_UP	= $7B
  2734 = 007C			TIME_ENTITY	= $7C
  2735 = 007D			TIME_BCD	= $7D
  2736 = 007E			LEVEL_BCD	= $7E
  2737 = 007F			LEVEL	= $7F
  2738 = 0080			SCORE_BCD	= $80
  2739 = 0082			HI_SCORE_BCD	= $82
  2740 = 0084			HEAD_POS	= $84
  2741 = 0086			HEAD_POS_COL	= $86
  2742 = 0088			TAIL_POS	= $88
  2743 = 008A			FRUIT_ON_BOARD	= $8A
  2744 = 008B			adr.SNAKE	= $8B
  2745 A9E8			.var SNAKE	= adr.SNAKE .word
  2746 = 008B			SNAKE.HEAD	= $8B
  2747 = 008C			SNAKE.BODY	= $8C
  2748 = 008D			SNAKE.M	= $8D
  2749 = 00FB			GAME_OVER	= $FB
  2750 = 00FB			SF0B	= $FB
  2751 = 00FC			SF1B	= $FC
  2752 = 1C05			HI_SCR_SCORE	= $1C05
  2753 = 1EEA			SCR_SCORE	= $1EEA
  2754 = 1ED9			SCR_LEVEL	= $1ED9
  2755 = 1EDE			SCR_TIME	= $1EDE
  2756 A9E8			@exit
  2757
  2758 A9E8 A2 00		@halt	ldx #$00
  2759 A9EA 9A				txs
  2760
  2761 A9EB 60				rts
  2762
  2763 				; ------------------------------------------------------------
  2764
  2765 				; ------------------------------------------------------------
  2766
  2767 A9EC			.local	@DEFINES
  2768 A9EC			RAW
  2769 				.endl
  2770
  2771 A9EC			.local	@RESOURCE
  2772 				.endl
  2773
  2774 = A9EC 0C A0		TXT_LEVEL
  2774 = A9EE 16 A0		TXT_POINTS
  2774 = A9F0 23 A0		TXT_TIME
  2774 = A9F2 29 A0		TXT_HSCORE
  2774 = A9F4 32 A0		TXT_FIRE
  2774 = A9F6 3E A0		TXT_TURBO
  2774 = A9F8 53 A0		TXT_INFO
  2774 = A9FA 8B 00		SNAKE
  2774 				.endl							; MAIN
  2775
  2776 				; ------------------------------------------------------------
  2777 				; ------------------------------------------------------------
  2778
  2779 				.macro	UNITINITIALIZATION
  2780 				
  2781 					.ifdef MAIN.SYSTEM.@UnitInit
  2782 					jsr MAIN.SYSTEM.@UnitInit
  2783 					.fi
  2784 				
  2785 					.ifdef MAIN.SYS_VIC20.@UnitInit
  2786 					jsr MAIN.SYS_VIC20.@UnitInit
  2787 					.fi
  2788 				.endm
  2789
  2790 				; ------------------------------------------------------------
  2791
  2792 					ift .SIZEOF(MAIN.SYSTEM) > 0
  2793 					.print 'SYSTEM: ',MAIN.SYSTEM,'..',MAIN.SYSTEM+.SIZEOF(MAIN.SYSTEM)-1
  2793 				SYSTEM: $A12D..$A15A
  2794 					eif
  2795
  2796 					ift .SIZEOF(MAIN.SYS_VIC20) > 0
  2797 					.print 'SYS_VIC20: ',MAIN.SYS_VIC20,'..',MAIN.SYS_VIC20+.SIZEOF(MAIN.SYS_VIC20)-1
  2797 				SYS_VIC20: $A15B..$A30C
  2798 					eif
  2799
  2800 					.print 'CODE: ',CODEORIGIN,'..',MAIN.@RESOURCE-1
  2800 				CODE: $A00C..$A9EB
  2801
  2802 				; ------------------------------------------------------------
  2803
  2804 A9FC				.align $0004
  2805
  2806 A9FC			DATAORIGIN
  2807
  2808 = 0000			VARINITSIZE	= *-DATAORIGIN
  2809 = 0010			VARDATASIZE	= 16
  2810
  2811 = AA0C			PROGRAMSTACK	= DATAORIGIN+VARDATASIZE
  2812
  2813 					.print 'DATA: ',DATAORIGIN,'..',PROGRAMSTACK
  2813 				DATA: $A9FC..$AA0C
  2814
  2815 				; ------------------------------------------------------------
  2816
  2817 				.macro	STATICDATA
  2818 				.by  $08 $0C $05 $16 $05 $0C $20 $30  $30 $00 $0B $10 $0F $09 $0E $14  $13 $20 $30 $30 $30 $30 $00 $04
  2819 				.by  $14 $3A $30 $30 $00 $07 $08 $09  $3A $30 $30 $30 $30 $00 $0A $10  $12 $05 $13 $13 $20 $06 $09 $12
  2820 				.by  $05 $00 $13 $08 $0F $0C $04 $20  $06 $09 $12 $05 $20 $06 $0F $12  $20 $14 $15 $12 $02 $0F $00 $17
  2821 				.by  $13 $03 $0F $12 $05 $20 $10 $0F  $09 $0E $14 $13 $20 $15 $0E $14  $09 $0C $20 $14 $3A $39 $39 $00
  2822 				.by  $09 $1A $19 $3C $00 $FC $00 $00  $FF $FF $00 $00 $00 $00 $00 $6E
  2823 				.endm
  2824
  2825 A9FC			.local	RESOURCE
  2826 A9FC				icl 'raw\resource.asm'
Source: resource.asm
     1
    48 					opt l+
  2827
  2828 A9FC				RCDATA 'res/title_cbm.scr' CRT_TITLE_ADR 0 0 0 0 0 0 0 0
Macro: RESOURCE.RCDATA [Source: resource.asm]
     6 A9FC				org main.CRT_TITLE_ADR
     8 B912 20 20 20 20 20 20 + 	ins 'res/title_cbm.scr',0
    10 					.print '$R RCDATA  ',main.CRT_TITLE_ADR,'..',*-1," 'res/title_cbm.scr'"
    10 				$R RCDATA  $B912..$BBFF 'res/title_cbm.scr'
Source: vic20.a65
  2829 BC00				RCDATA 'res/snake_cbm.fnt' CRT_CHARS_ADR 0 0 0 0 0 0 0 0
Macro: RESOURCE.RCDATA [Source: resource.asm]
     6 BC00				org main.CRT_CHARS_ADR
     8 BC00 00 3C 66 6E 6E 60 + 	ins 'res/snake_cbm.fnt',0
    10 					.print '$R RCDATA  ',main.CRT_CHARS_ADR,'..',*-1," 'res/snake_cbm.fnt'"
    10 				$R RCDATA  $BC00..$BFFF 'res/snake_cbm.fnt'
Source: vic20.a65
  2830 				.endl
  2831
  2832 					end
